\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp}{
\section{MVCCommonLib/Codec/PBPredict.cpp File Reference}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp}\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
}
{\ttfamily \#include \char`\"{}PBPredict.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Common.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}PictureInfo.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/Consts4Standard.h\char`\"{}}\par
Include dependency graph for PBPredict.cpp:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=240pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=124pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a81e10c9842cf86af8be7c19452a9228f}{macroblockPredGetDataY} (\hyperlink{struct_p_b_predict_info}{PBPredictInfo} $\ast$pif, \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8\_\-t} $\ast$dat, int px, int py, int sx, int sy)
\item 
void \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aa4b361a63a442d1eda917f37b6a5fd1d}{macroblockPredGetDataUV} (\hyperlink{struct_p_b_predict_info}{PBPredictInfo} $\ast$pif, \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8\_\-t} $\ast$dat, int px, int py, int sx, int sy)
\item 
void \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50}{macroblockGetPred\_\-axb} (int listid, const \hyperlink{structref_vector}{refVector} \&ref, \hyperlink{struct_p_b_predict_info}{PBPredictInfo} $\ast$pif, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$pred, int sizex, int sizey, int off\_\-in\_\-x, int off\_\-in\_\-y)
\item 
void \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a6adf1c1a57809fc88604a894304bd924}{macroblockGetPred\_\-axb\_\-Bi} (const \hyperlink{structref_vector}{refVector} \&ref0, const \hyperlink{structref_vector}{refVector} \&ref1, \hyperlink{struct_p_b_predict_info}{PBPredictInfo} $\ast$pif, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$pred, int sizex, int sizey, int off\_\-in\_\-x, int off\_\-in\_\-y)
\item 
void \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_ae44b074ea50d2c5f47d11065eee71c3a}{macroblockGetHalfPel} (\hyperlink{struct_p_b_predict_info}{PBPredictInfo} $\ast$pif, int hw, int hh)
\item 
int \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a1ebf436cd932cc02e36d3e20c24f7a73}{getSAD} (\hyperlink{structmacroblockdata}{macroblockdata} $\ast$data, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$pred)
\item 
int \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_af7d15d5af074dd965dff83d25049c9b5}{getSAD\_\-axb} (\hyperlink{structmacroblockdata}{macroblockdata} $\ast$data, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$pred, int sizex, int sizey, int off\_\-in\_\-x, int off\_\-in\_\-y)
\item 
int \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a0bd49accaa4aae5fe46729ab919210e2}{motionCost} (int n\_\-ref, int x, int y)
\item 
void \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a9bf71cd5cc7efb47cefa4dc05a66d1a0}{macroblockPBPrediction} (\hyperlink{struct_coding_pict_info}{CodingPictInfo} $\ast$cpi, \hyperlink{struct_p_b_predict_info}{PBPredictInfo} $\ast$pif, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$dif, \hyperlink{structmacroblock_info}{macroblockInfo} $\ast$mif, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$pred)
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a1ebf436cd932cc02e36d3e20c24f7a73}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!getSAD@{getSAD}}
\index{getSAD@{getSAD}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{getSAD}]{\setlength{\rightskip}{0pt plus 5cm}int getSAD ({\bf macroblockdata} $\ast$ {\em data}, \/  {\bf macroblockdata} $\ast$ {\em pred})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a1ebf436cd932cc02e36d3e20c24f7a73}




\begin{footnotesize}\begin{alltt}
00399 \{
00400         \textcolor{keywordtype}{int} sad = 0;
00401         \textcolor{comment}{//int i, j;}
00402         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; ++i)
00403                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 16; ++j)
00404                         sad += labs((\textcolor{keywordtype}{int})data->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i][j] - (\textcolor{keywordtype}{int})pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i][j]);
00405         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00406                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00407                         sad += labs((\textcolor{keywordtype}{int})data->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][i][j] - (\textcolor{keywordtype}{int})pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][i][
      j]);
00408         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00409                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00410                         sad += labs((\textcolor{keywordtype}{int})data->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][i][j] - (\textcolor{keywordtype}{int})pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][i][
      j]);
00411         \textcolor{keywordflow}{return} sad;
00412 \}
\end{alltt}\end{footnotesize}


\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_af7d15d5af074dd965dff83d25049c9b5}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!getSAD\_\-axb@{getSAD\_\-axb}}
\index{getSAD\_\-axb@{getSAD\_\-axb}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{getSAD\_\-axb}]{\setlength{\rightskip}{0pt plus 5cm}int getSAD\_\-axb ({\bf macroblockdata} $\ast$ {\em data}, \/  {\bf macroblockdata} $\ast$ {\em pred}, \/  int {\em sizex}, \/  int {\em sizey}, \/  int {\em off\_\-in\_\-x}, \/  int {\em off\_\-in\_\-y})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_af7d15d5af074dd965dff83d25049c9b5}




\begin{footnotesize}\begin{alltt}
00415 \{
00416         \textcolor{keywordtype}{int} sad = 0;
00417         \textcolor{comment}{//int i, j;}
00418         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00419                 \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
00420                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey; ++j)
00421                         sad += labs((\textcolor{keywordtype}{int})data->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][j+off\_in\_y] - (\textcolor{keywordtype}{int})pred
      ->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][j+off\_in\_y]);
00422         \}
00423         \textcolor{keywordtype}{int} sizex\_half = sizex / 2,
00424                 sizey\_half = sizey / 2,
00425                 off\_in\_x\_half = off\_in\_x / 2,
00426                 off\_in\_y\_half = off\_in\_y / 2;
00427         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex\_half; ++i)
00428                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey\_half; ++j)
00429                         sad += labs((\textcolor{keywordtype}{int})data->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][i+off\_in\_x\_half][j+off\_in\_y\_
      half] - (\textcolor{keywordtype}{int})pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][i+off\_in\_x\_half][j+off\_in\_y\_half]);
00430         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex\_half; ++i)
00431                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey\_half; ++j)
00432                         sad += labs((\textcolor{keywordtype}{int})data->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][i+off\_in\_x\_half][j+off\_in\_y\_
      half] - (\textcolor{keywordtype}{int})pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][i+off\_in\_x\_half][j+off\_in\_y\_half]);
00433         \textcolor{keywordflow}{return} sad;
00434 \}
\end{alltt}\end{footnotesize}


\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_ae44b074ea50d2c5f47d11065eee71c3a}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!macroblockGetHalfPel@{macroblockGetHalfPel}}
\index{macroblockGetHalfPel@{macroblockGetHalfPel}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{macroblockGetHalfPel}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockGetHalfPel ({\bf PBPredictInfo} $\ast$ {\em pif}, \/  int {\em hw}, \/  int {\em hh})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_ae44b074ea50d2c5f47d11065eee71c3a}




\begin{footnotesize}\begin{alltt}
00346 \{
00347         \textcolor{keywordtype}{int} tmp[24][24];
00348         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < hw; ++i)
00349                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 2; j < hh - 3; ++j)
00350                 \{
00351                         pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][i][j] =
00352                                 \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(
00353                                           (pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j-2]
00354                                 -  5 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j-1]
00355                                 + 20 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j]
00356                                 + 20 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j+1]
00357                                 -  5 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j+2]
00358                                 +      pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j+3] + 16)
00359                                 / 32);
00360                         tmp[i][j] =
00361                                            pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j-2]
00362                                 -  5 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j-1]
00363                                 + 20 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j]
00364                                 + 20 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j+1]
00365                                 -  5 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j+2]
00366                                 +      pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j+3];
00367                 \}
00368         
00369         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 2; i < hw - 3; ++i)
00370                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < hh; ++j)
00371                 \{
00372                         pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][i][j] =
00373                                 \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(
00374                                           (pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i-2][j]
00375                                 -  5 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i-1][j]
00376                                 + 20 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j]
00377                                 + 20 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i+1][j]
00378                                 -  5 * pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i+2][j]
00379                                 +      pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i+3][j] + 16) 
00380                                 / 32);
00381                 \}
00382         
00383         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 2; i < hw - 3; ++i)
00384                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 2; j < hh - 3; ++j)
00385                 \{
00386                         pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[2][i][j] =
00387                                 \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(
00388                                           (tmp[i-2][j]
00389                                 -  5 * tmp[i-1][j]
00390                                 + 20 * tmp[i][j]
00391                                 + 20 * tmp[i+1][j]
00392                                 -  5 * tmp[i+2][j]
00393                                 +      tmp[i+3][j] + 512) 
00394                                 / 1024);
00395                 \}
00396 \}
\end{alltt}\end{footnotesize}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_ae44b074ea50d2c5f47d11065eee71c3a_icgraph}
\end{center}
\end{figure}


\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!macroblockGetPred\_\-axb@{macroblockGetPred\_\-axb}}
\index{macroblockGetPred\_\-axb@{macroblockGetPred\_\-axb}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{macroblockGetPred\_\-axb}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockGetPred\_\-axb (int {\em listid}, \/  const {\bf refVector} \& {\em ref}, \/  {\bf PBPredictInfo} $\ast$ {\em pif}, \/  {\bf macroblockdata} $\ast$ {\em pred}, \/  int {\em sizex}, \/  int {\em sizey}, \/  int {\em off\_\-in\_\-x}, \/  int {\em off\_\-in\_\-y})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50}




\begin{footnotesize}\begin{alltt}
00078 \{
00079 
00080         \textcolor{keywordtype}{int} px = pif->\hyperlink{struct_p_b_predict_info_a1eda4a8837300bed803d81ada5dfbb30}{myr} * 16 + off\_in\_x, py = pif->\hyperlink{struct_p_b_predict_info_ac46c76693de4dab4a105494d1220dc0a}{myc} * 16 + off\_in\_y;
00081         \textcolor{keywordtype}{int} rx = px * 4 + ref.\hyperlink{structref_vector_adeb9dca3f08b25112b9f6bccb5002f48}{x}, ry = py * 4 + ref.\hyperlink{structref_vector_a899825821ce74c5622ea369e32dcf67c}{y};
00082         \textcolor{keywordtype}{int} subx = ref.\hyperlink{structref_vector_adeb9dca3f08b25112b9f6bccb5002f48}{x} & 3, suby = ref.\hyperlink{structref_vector_a899825821ce74c5622ea369e32dcf67c}{y} & 3;
00083         \textcolor{keywordtype}{int} rtx = (rx - subx) / 4, rty = (ry - suby) / 4;
00084         \textcolor{keywordtype}{int} border = 2;
00085         \textcolor{comment}{//int i, j;}
00086 
00087         \textcolor{keywordflow}{if} (subx==0 && suby==0) \textcolor{comment}{// Direct}
00088         \{  \textcolor{comment}{// Full-pel}
00089                 \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a81e10c9842cf86af8be7c19452a9228f}{macroblockPredGetDataY}(pif, pif->\hyperlink{struct_p_b_predict_info_a7c7d2c72aa539c0e2365b4e04e18a0ca}{pdata_y0}[listid][ref.\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno}], rtx
      , rty, sizex + 1, sizey + 1);
00090                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00091                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
00092                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey; ++j)
00093                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][j+off\_in\_y] = pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j];
00094                 \}
00095         \}
00096         \textcolor{keywordflow}{else}
00097         \{
00098                 \textcolor{keywordtype}{int} borderT = 0, borderL = 0;
00099                 \textcolor{keywordflow}{if} (subx)
00100                         borderT = 2;
00101                 \textcolor{keywordflow}{if} (suby)
00102                         borderL = 2;
00103                 \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a81e10c9842cf86af8be7c19452a9228f}{macroblockPredGetDataY}(pif, pif->\hyperlink{struct_p_b_predict_info_a7c7d2c72aa539c0e2365b4e04e18a0ca}{pdata_y0}[listid][ref.\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno}], rtx
       - borderT, rty - borderL, borderT * 2 + sizex + 1, borderL * 2 + sizey + 1);
00104                 \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_ae44b074ea50d2c5f47d11065eee71c3a}{macroblockGetHalfPel}(pif, borderT * 2 + sizex + 1, borderL * 2 + 
      sizey + 1);
00105 
00106                 \textcolor{keywordflow}{if} ((subx&1)==0 && (suby&1)==0)
00107                 \{  \textcolor{comment}{// Half-pel}
00108                         \textcolor{keywordtype}{int} halfid = -1;
00109                         \textcolor{keywordflow}{if} (subx)
00110                                 halfid += 2;
00111                         \textcolor{keywordflow}{if} (suby)
00112                                 halfid += 1;
00113                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00114                                 \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
00115                                 \textcolor{keywordtype}{int} iboarterT = i+borderT;
00116                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey; ++j)
00117                                         pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][j+off\_in\_y] = pif->
      \hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[halfid][iboarterT][j+borderL];
00118                         \}
00119                 \}
00120                 \textcolor{keywordflow}{else}
00121                 \{  \textcolor{comment}{// Quart-pel}
00122                         \textcolor{keywordtype}{int} boarderLplusone = borderL+1;
00123                         \textcolor{keywordtype}{int} boarderTplusone = borderT+1;
00124                         \textcolor{keywordflow}{switch} (subx)
00125                         \{
00126                         \textcolor{keywordflow}{case} 0: 
00127                                 \{
00128                                         \textcolor{keywordflow}{switch}(suby)
00129                                         \{
00130                                         \textcolor{comment}{//case 0:}
00131                                         \textcolor{keywordflow}{case} 1:
00132                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00133                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00134                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00135                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00136                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[iboarterT][j+borderL] + pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][iboarterT][j
      +borderL] + 1) >> 1;
00137                                                 \}
00138                                                 \textcolor{keywordflow}{break};
00139                                         \textcolor{comment}{//case 2:}
00140                                         \textcolor{keywordflow}{case} 3:
00141                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00142                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00143                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00144                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00145                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[iboarterT][j+boarderLplusone] + pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][iboa
      rterT][j+borderL] + 1) >> 1;
00146                                                 \}
00147                                                 \textcolor{keywordflow}{break};
00148                                         \textcolor{keywordflow}{default}:\textcolor{keywordflow}{break};
00149                                         \}
00150                                 \}
00151                                 \textcolor{keywordflow}{break};
00152                         \textcolor{keywordflow}{case} 1: 
00153                                 \{
00154                                         \textcolor{keywordflow}{switch}(suby)
00155                                         \{
00156                                         \textcolor{keywordflow}{case} 0:
00157                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00158                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00159                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00160                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00161                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[iboarterT][j+borderL] + pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][iboarterT][j
      +borderL] + 1) >> 1;
00162                                                 \}
00163                                                 \textcolor{keywordflow}{break};
00164                                         \textcolor{keywordflow}{case} 1:
00165                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00166                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00167                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00168                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00169                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][iboarterT][j+borderL] + pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][iboa
      rterT][j+borderL] + 1) >> 1;
00170                                                 \}
00171                                                 \textcolor{keywordflow}{break};
00172                                         \textcolor{keywordflow}{case} 2:
00173                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00174                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00175                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00176                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00177                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][iboarterT][j+borderL] + pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[2][iboa
      rterT][j+borderL] + 1) >> 1;
00178                                                 \}
00179                                                 \textcolor{keywordflow}{break};
00180                                         \textcolor{keywordflow}{case} 3:
00181                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00182                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00183                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00184                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00185                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][iboarterT][j+borderL] + pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][iboa
      rterT][j+boarderLplusone] + 1) >> 1;
00186                                                 \}
00187                                                 \textcolor{keywordflow}{break};
00188                                         \textcolor{keywordflow}{default}:\textcolor{keywordflow}{break};
00189                                         \}
00190                                 \}
00191                                 \textcolor{keywordflow}{break};
00192                         \textcolor{keywordflow}{case} 2: 
00193                                 \{
00194                                         \textcolor{keywordflow}{switch}(suby)
00195                                         \{
00196                                         \textcolor{comment}{//case 0:}
00197                                         \textcolor{keywordflow}{case} 1:
00198                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00199                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00200                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00201                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00202                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][iboarterT][j+borderL] + pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[2][iboa
      rterT][j+borderL] + 1) >> 1;
00203                                                 \}
00204                                                 \textcolor{keywordflow}{break};
00205                                         \textcolor{comment}{//case 2:}
00206                                         \textcolor{keywordflow}{case} 3:
00207                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00208                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00209                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00210                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00211                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][iboarterT][j+boarderLplusone] + pif->
      \hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[2][iboarterT][j+borderL] + 1) >> 1;
00212                                                 \}
00213                                                 \textcolor{keywordflow}{break};
00214                                         \textcolor{keywordflow}{default}:\textcolor{keywordflow}{break};
00215                                         \}
00216                                 \}
00217                                 \textcolor{keywordflow}{break};
00218                         \textcolor{keywordflow}{case} 3: 
00219                                 \{
00220                                         \textcolor{keywordflow}{switch}(suby)
00221                                         \{
00222                                         \textcolor{keywordflow}{case} 0:
00223                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00224                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00225                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00226                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00227                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i+boarderTplusone][j+borderL] + pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][iboa
      rterT][j+borderL] + 1) >> 1;
00228                                                 \}
00229                                                 \textcolor{keywordflow}{break};
00230                                         \textcolor{keywordflow}{case} 1:
00231                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00232                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00233                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00234                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00235                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][i+boarderTplusone][j+borderL] + pif->
      \hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][iboarterT][j+borderL] + 1) >> 1;
00236                                                 \}
00237                                                 \textcolor{keywordflow}{break};
00238                                         \textcolor{keywordflow}{case} 2:
00239                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00240                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00241                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00242                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00243                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][i+boarderTplusone][j+borderL] + pif->
      \hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[2][iboarterT][j+borderL] + 1) >> 1;
00244                                                 \}
00245                                                 \textcolor{keywordflow}{break};
00246                                         \textcolor{keywordflow}{case} 3:
00247                                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00248                                                         \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
      
00249                                                         \textcolor{keywordtype}{int} iboarterT = i+borderT
      ;
00250                                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey
      ; ++j)
00251                                                                 pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][
      j+off\_in\_y] = (pif->\hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[0][i+boarderTplusone][j+borderL] + pif->
      \hyperlink{struct_p_b_predict_info_ae10de4e25fedb10d0ea1dbaf3b34c4ac}{vdata_half}[1][iboarterT][j+boarderLplusone] + 1) >> 1;
00252                                                 \}
00253                                                 \textcolor{keywordflow}{break};
00254                                         \textcolor{keywordflow}{default}:\textcolor{keywordflow}{break};
00255                                         \}
00256                                 \}
00257                                 \textcolor{keywordflow}{break};
00258                         \textcolor{keywordflow}{default}:\textcolor{keywordflow}{break};
00259                         \}
00260                 \}
00261         \}
00262 
00263 
00264         \textcolor{keywordtype}{int} off\_in\_x\_half = off\_in\_x / 2, 
00265                 off\_in\_y\_half = off\_in\_y / 2,
00266                 sizex\_half = sizex / 2,
00267                 sizey\_half = sizey / 2;
00268         subx = ref.\hyperlink{structref_vector_adeb9dca3f08b25112b9f6bccb5002f48}{x} & 7, suby = ref.\hyperlink{structref_vector_a899825821ce74c5622ea369e32dcf67c}{y} & 7;
00269         \textcolor{keywordtype}{int} C1 = (8-subx)*(8-suby), C2 = (8-subx)*(  suby), C3 = (  subx)*(8-suby
      ), C4 = (  subx)*(  suby);
00270         \textcolor{keywordtype}{int} rutx = (rx - subx) / 8, ruty = (ry - suby) / 8;
00271 
00272         \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aa4b361a63a442d1eda917f37b6a5fd1d}{macroblockPredGetDataUV}(pif, pif->\hyperlink{struct_p_b_predict_info_aaf07e44714249f4131c030df88bf8169}{pdata_u0}[listid][ref.\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno}], rutx, ruty
      , sizex / 2 + 1, sizey / 2 + 1);
00273         \textcolor{keywordflow}{if} (subx==0 && suby==0)
00274         \{
00275                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex\_half; ++i)
00276                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey\_half; ++j)
00277                                 pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][i+off\_in\_x\_half][j+off\_in\_y\_half] = p
      if->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j];
00278         \}
00279         \textcolor{keywordflow}{else}
00280         \{
00281                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex\_half; ++i)
00282                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey\_half; ++j)
00283                         \{
00284                                 pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][i+off\_in\_x\_half][j+off\_in\_y\_half] = (
      
00285                                         C1*pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i  ][j  ]+
00286                                         C2*pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i  ][j+1]+
00287                                         C3*pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i+1][j  ]+
00288                                         C4*pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i+1][j+1]+
00289                                         32) >> 6;
00290                         \}
00291         \}
00292 
00293         \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aa4b361a63a442d1eda917f37b6a5fd1d}{macroblockPredGetDataUV}(pif, pif->\hyperlink{struct_p_b_predict_info_a8dc8f424bcb4274ef583207aa9827962}{pdata_v0}[listid][ref.\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno}], rutx, ruty
      , sizex / 2 + 1, sizey / 2 + 1);
00294         \textcolor{keywordflow}{if} (subx==0 && suby==0)
00295         \{
00296                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex\_half; ++i)
00297                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey\_half; ++j)
00298                                 pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][i+off\_in\_x\_half][j+off\_in\_y\_half] = p
      if->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i][j];
00299         \}
00300         \textcolor{keywordflow}{else}
00301         \{
00302                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex\_half; ++i)
00303                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey\_half; ++j)
00304                         \{
00305                                 pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][i+off\_in\_x\_half][j+off\_in\_y\_half] = (
      
00306                                         C1*pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i  ][j  ]+
00307                                         C2*pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i  ][j+1]+
00308                                         C3*pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i+1][j  ]+
00309                                         C4*pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i+1][j+1]+
00310                                         32) >> 6;
00311                         \}
00312         \}
00313 
00314 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=171pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50_icgraph}
\end{center}
\end{figure}


\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a6adf1c1a57809fc88604a894304bd924}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!macroblockGetPred\_\-axb\_\-Bi@{macroblockGetPred\_\-axb\_\-Bi}}
\index{macroblockGetPred\_\-axb\_\-Bi@{macroblockGetPred\_\-axb\_\-Bi}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{macroblockGetPred\_\-axb\_\-Bi}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockGetPred\_\-axb\_\-Bi (const {\bf refVector} \& {\em ref0}, \/  const {\bf refVector} \& {\em ref1}, \/  {\bf PBPredictInfo} $\ast$ {\em pif}, \/  {\bf macroblockdata} $\ast$ {\em pred}, \/  int {\em sizex}, \/  int {\em sizey}, \/  int {\em off\_\-in\_\-x}, \/  int {\em off\_\-in\_\-y})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a6adf1c1a57809fc88604a894304bd924}




\begin{footnotesize}\begin{alltt}
00319 \{
00320         \hyperlink{structmacroblockdata}{macroblockdata} tempPred;
00321         \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50}{macroblockGetPred_axb}(0, ref0, pif, pred, sizex, sizey, off\_in\_x, off\_in\_
      y);
00322         \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50}{macroblockGetPred_axb}(1, ref1, pif, &tempPred, sizex, sizey, off\_in\_x, of
      f\_in\_y);
00323         \textcolor{comment}{//int i, j;}
00324         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex; ++i)\{
00325                 \textcolor{keywordtype}{int} ioffinx = i+off\_in\_x;
00326                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey; ++j)
00327                         pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][j+off\_in\_y] = (pred->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][j+off\_in
      \_y] + tempPred.\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[ioffinx][j+off\_in\_y] + 1) >> 1;
00328         \}
00329         \textcolor{keywordtype}{int} off\_in\_x\_uv = off\_in\_x / 2, off\_in\_y\_uv = off\_in\_y / 2;
00330         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex/2; ++i)\{
00331                 \textcolor{keywordtype}{int} ioffinuv = i+off\_in\_x\_uv;
00332                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey/2; ++j)
00333                         pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][ioffinuv][j+off\_in\_y\_uv] = (pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][ioffi
      nuv][j+off\_in\_y\_uv] + tempPred.\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0][ioffinuv][j+off\_in\_y\_uv] + 1) >> 1;
00334         \}
00335         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sizex/2; ++i)\{
00336                 \textcolor{keywordtype}{int} ioffinuv = i+off\_in\_x\_uv;
00337                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < sizey/2; ++j)
00338                         pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][ioffinuv][j+off\_in\_y\_uv] = (pred->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][ioffi
      nuv][j+off\_in\_y\_uv] + tempPred.\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1][ioffinuv][j+off\_in\_y\_uv] + 1) >> 1;
00339         \}
00340 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=258pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a6adf1c1a57809fc88604a894304bd924_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a6adf1c1a57809fc88604a894304bd924_icgraph}
\end{center}
\end{figure}


\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a9bf71cd5cc7efb47cefa4dc05a66d1a0}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!macroblockPBPrediction@{macroblockPBPrediction}}
\index{macroblockPBPrediction@{macroblockPBPrediction}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{macroblockPBPrediction}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockPBPrediction ({\bf CodingPictInfo} $\ast$ {\em cpi}, \/  {\bf PBPredictInfo} $\ast$ {\em pif}, \/  {\bf macroblockdata} $\ast$ {\em dif}, \/  {\bf macroblockInfo} $\ast$ {\em mif}, \/  {\bf macroblockdata} $\ast$ {\em pred})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a9bf71cd5cc7efb47cefa4dc05a66d1a0}




\begin{footnotesize}\begin{alltt}
00487 \{
00488         \textcolor{keywordtype}{bool} ok[4][4] = \{0\};
00489         \textcolor{comment}{//macroblockGetHalfPel(pif, cpi);}
00490         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 4; ++i)
00491                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 4; ++j)
00492                 \{
00493                         \textcolor{keywordtype}{int} x = i, y = j;
00494                         \textcolor{keywordflow}{if} (ok[i][j])
00495                                 \textcolor{keywordflow}{continue};
00496                         \textcolor{keywordflow}{while} ((x || y) && \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8h_a7a22ccaef4a3c56a0ac3b9df8eb05e1d}{noRefs}(mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y]))
00497                         \{
00498                                 printf(\textcolor{stringliteral}{"REF Error!!!\(\backslash\)n"});
00499                                 x = x & (x - 1);
00500                                 y = y & (y - 1);
00501                         \}
00502                         \textcolor{keywordtype}{int} wd = 1, ht = 1;
00503                         \textcolor{keywordflow}{while} (x+ht < 4 && (\hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8h_a7a22ccaef4a3c56a0ac3b9df8eb05e1d}{noRefs}(mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x+ht][y]) || 
      \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8h_aafd6da6f8c9a163910095d70b80462e7}{refsEqual}(mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x+ht][y], mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y])))
00504                         \{
00505                                 ++ht;
00506                         \}
00507                         \textcolor{keywordflow}{while} (y+wd < 4)
00508                         \{
00509                                 \textcolor{keywordtype}{bool} sm = \textcolor{keyword}{true};
00510                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < ht; ++k)
00511                                         \textcolor{keywordflow}{if} (!\hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8h_a7a22ccaef4a3c56a0ac3b9df8eb05e1d}{noRefs}(mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x+k][y]) || !
      \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8h_aafd6da6f8c9a163910095d70b80462e7}{refsEqual}(mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x+k][y],mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x+k][y+wd]))
00512                                         \{
00513                                                 sm = \textcolor{keyword}{false};
00514                                                 \textcolor{keywordflow}{break};
00515                                         \}
00516                                 \textcolor{keywordflow}{if} (!sm)
00517                                         \textcolor{keywordflow}{break};
00518                                 ++wd;
00519                         \}
00520                         \textcolor{keywordflow}{if} ((mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y][0].\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno} < 0) && (mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y][1]
      .\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno} < 0))
00521                         \{
00522                                 printf(\textcolor{stringliteral}{"REF Error!!!\(\backslash\)n"});
00523                                 \hyperlink{structref_vector}{refVector} ref;
00524                                 ref.\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno} = 0;
00525                                 ref.\hyperlink{structref_vector_adeb9dca3f08b25112b9f6bccb5002f48}{x} = 0;
00526                                 ref.\hyperlink{structref_vector_a899825821ce74c5622ea369e32dcf67c}{y} = 0;
00527                                 \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50}{macroblockGetPred_axb}(0, ref, pif, pred, 4*ht, 4*
      wd, i*4, j*4);
00528                         \}
00529                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y][0].\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno} < 0)
00530                         \{
00531                                 \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50}{macroblockGetPred_axb}(1, mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y][1], pif,
       pred, 4*ht, 4*wd, i*4, j*4);
00532                         \}
00533                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y][1].\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno} < 0)
00534                         \{
00535                                 \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aae19b8dbe8243ab186626f8b8570ef50}{macroblockGetPred_axb}(0, mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y][0], pif,
       pred, 4*ht, 4*wd, i*4, j*4);
00536                         \}
00537                         \textcolor{keywordflow}{else}
00538                         \{
00539                                 \hyperlink{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a6adf1c1a57809fc88604a894304bd924}{macroblockGetPred_axb_Bi}(mif->\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y][0], mif-
      >\hyperlink{structmacroblock_info_a8501600ad3ab8d7865c28c8398e900f9}{refs}[x][y][1], pif, pred, 4*ht, 4*wd, i*4, j*4);
00540                         \}
00541                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < ht; ++k)
00542                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < wd; ++l)
00543                                 \{
00544                                         ok[x+k][y+l] = \textcolor{keyword}{true};
00545                                 \}
00546                 \}
00547 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a9bf71cd5cc7efb47cefa4dc05a66d1a0_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=417pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a9bf71cd5cc7efb47cefa4dc05a66d1a0_icgraph}
\end{center}
\end{figure}


\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aa4b361a63a442d1eda917f37b6a5fd1d}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!macroblockPredGetDataUV@{macroblockPredGetDataUV}}
\index{macroblockPredGetDataUV@{macroblockPredGetDataUV}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{macroblockPredGetDataUV}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockPredGetDataUV ({\bf PBPredictInfo} $\ast$ {\em pif}, \/  {\bf uint8\_\-t} $\ast$ {\em dat}, \/  int {\em px}, \/  int {\em py}, \/  int {\em sx}, \/  int {\em sy})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aa4b361a63a442d1eda917f37b6a5fd1d}




\begin{footnotesize}\begin{alltt}
00046 \{
00047         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sx; ++i)
00048         \{
00049                 \textcolor{keywordtype}{int} x = px + i;
00050                 \textcolor{keywordflow}{if} (x<0) x = 0;
00051                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x >= pif->\hyperlink{struct_p_b_predict_info_a22f7b2cc9619bf678980e45fc9ef7f1b}{sizeh}/2) x = pif->\hyperlink{struct_p_b_predict_info_a22f7b2cc9619bf678980e45fc9ef7f1b}{sizeh}/2 - 1;
00052                 \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8_t} *linef = dat + x * pif->\hyperlink{struct_p_b_predict_info_a96c9413deeef7bfcd16237bfef11c8ae}{stride} / 2;
00053                 \textcolor{keywordtype}{int} dl = 0, sl = py, sr = py + sy;
00054                 \textcolor{keywordflow}{if} (sl < 0)
00055                 \{
00056                         dl -= sl;
00057                         sl = 0;
00058                 \}
00059                 \textcolor{keywordflow}{if} (sr > pif->\hyperlink{struct_p_b_predict_info_a26162322380d1afd96ee0c894f6ee08e}{sizew}/2)
00060                         sr = pif->\hyperlink{struct_p_b_predict_info_a26162322380d1afd96ee0c894f6ee08e}{sizew}/2;
00061                 \textcolor{keywordtype}{int} le = sr - sl;
00062                 \textcolor{keywordflow}{if} (le < 0) le = 0;
00063                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (le > 0)
00064                         memcpy(pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i]+dl, linef + sl, le);
00065                 \textcolor{keywordflow}{if} (dl > 0)
00066                 \{
00067                         memset(pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i], *linef, dl);
00068                 \}
00069                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (le < sy)
00070                 \{
00071                         memset(pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i] + le, linef[pif->\hyperlink{struct_p_b_predict_info_a26162322380d1afd96ee0c894f6ee08e}{sizew}/2 - 1], sy - 
      le);
00072                 \}
00073         \}
00074 \}
\end{alltt}\end{footnotesize}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_aa4b361a63a442d1eda917f37b6a5fd1d_icgraph}
\end{center}
\end{figure}


\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a81e10c9842cf86af8be7c19452a9228f}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!macroblockPredGetDataY@{macroblockPredGetDataY}}
\index{macroblockPredGetDataY@{macroblockPredGetDataY}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{macroblockPredGetDataY}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockPredGetDataY ({\bf PBPredictInfo} $\ast$ {\em pif}, \/  {\bf uint8\_\-t} $\ast$ {\em dat}, \/  int {\em px}, \/  int {\em py}, \/  int {\em sx}, \/  int {\em sy})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a81e10c9842cf86af8be7c19452a9228f}




\begin{footnotesize}\begin{alltt}
00015 \{
00016         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < sx; ++i)
00017         \{
00018                 \textcolor{keywordtype}{int} x = px + i;
00019                 \textcolor{keywordflow}{if} (x<0) x = 0;
00020                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x >= pif->\hyperlink{struct_p_b_predict_info_a22f7b2cc9619bf678980e45fc9ef7f1b}{sizeh}) x = pif->\hyperlink{struct_p_b_predict_info_a22f7b2cc9619bf678980e45fc9ef7f1b}{sizeh} - 1;
00021                 \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8_t} *linef = dat + x * pif->\hyperlink{struct_p_b_predict_info_a96c9413deeef7bfcd16237bfef11c8ae}{stride};
00022                 \textcolor{keywordtype}{int} dl = 0, sl = py, sr = py + sy;
00023                 \textcolor{keywordflow}{if} (sl < 0)
00024                 \{
00025                         dl -= sl;
00026                         sl = 0;
00027                 \}
00028                 \textcolor{keywordflow}{if} (sr > pif->\hyperlink{struct_p_b_predict_info_a26162322380d1afd96ee0c894f6ee08e}{sizew})
00029                         sr = pif->\hyperlink{struct_p_b_predict_info_a26162322380d1afd96ee0c894f6ee08e}{sizew};
00030                 \textcolor{keywordtype}{int} le = sr - sl;
00031                 \textcolor{keywordflow}{if} (le < 0) le = 0;
00032                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (le != 0)
00033                         memcpy(pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i]+dl, linef + sl, le);
00034                 \textcolor{keywordflow}{if} (dl > 0)
00035                 \{
00036                         memset(pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i], *linef, dl);
00037                 \}
00038                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (le < sy)
00039                 \{
00040                         memset(pif->\hyperlink{struct_p_b_predict_info_aaa7f5b9d6def9506a306d9e5fdf0c7f4}{vdata}[i] + le, linef[pif->\hyperlink{struct_p_b_predict_info_a26162322380d1afd96ee0c894f6ee08e}{sizew} - 1], sy - le
      );
00041                 \}
00042         \}
00043 \}
\end{alltt}\end{footnotesize}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a81e10c9842cf86af8be7c19452a9228f_icgraph}
\end{center}
\end{figure}


\hypertarget{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a0bd49accaa4aae5fe46729ab919210e2}{
\index{MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}!motionCost@{motionCost}}
\index{motionCost@{motionCost}!MVCCommonLib/Codec/PBPredict.cpp@{MVCCommonLib/Codec/PBPredict.cpp}}
\subsubsection[{motionCost}]{\setlength{\rightskip}{0pt plus 5cm}int motionCost (int {\em n\_\-ref}, \/  int {\em x}, \/  int {\em y})}}
\label{_m_v_c_common_lib_2_codec_2_p_b_predict_8cpp_a0bd49accaa4aae5fe46729ab919210e2}




\begin{footnotesize}\begin{alltt}
00438 \{
00439         \textcolor{comment}{// TODO: Calculate motion cost}
00440         \textcolor{comment}{// Temporary usage}
00441         \textcolor{keywordtype}{int} ret = 0;
00442         \textcolor{keywordflow}{if} (x<0)
00443         \{
00444                 ++ret;
00445                 x = -x;
00446         \}
00447         \textcolor{keywordflow}{if} (y<0)
00448         \{
00449                 ++ret;
00450                 y = -y;
00451         \}
00452         \textcolor{keywordflow}{while} (n\_ref)
00453         \{
00454                 n\_ref >>= 1;
00455                 ++ret;
00456         \}
00457         \textcolor{keywordflow}{while} (x)
00458         \{
00459                 x >>= 1;
00460                 ++ret;
00461         \}
00462         \textcolor{keywordflow}{while} (y)
00463         \{
00464                 y >>= 1;
00465                 ++ret;
00466         \}
00467         \textcolor{keywordflow}{return} ret * 8;
00468 \}
\end{alltt}\end{footnotesize}


