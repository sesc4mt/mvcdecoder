\hypertarget{_i_slice_8cpp}{
\section{MVCDecoder/Codec/IFrame/ISlice.cpp File Reference}
\label{_i_slice_8cpp}\index{MVCDecoder/Codec/IFrame/ISlice.cpp@{MVCDecoder/Codec/IFrame/ISlice.cpp}}
}
{\ttfamily \#include \char`\"{}ISlice.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Common.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/Bitstream.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}PictureInfo.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}IMacroblockCodec.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}ICAVLC.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/IFrame/IPredict.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/Consts4Standard.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Debug.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Arch/Arch.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/ConfigureSlave.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/CAVLC.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/vlcPred.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/LoopFilter.h\char`\"{}}\par
Include dependency graph for ISlice.cpp:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_i_slice_8cpp__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=123pt]{_i_slice_8cpp__dep__incl}
\end{center}
\end{figure}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
struct \hyperlink{structtag__macroblock__info}{tag\_\-macroblock\_\-info}
\end{DoxyCompactItemize}
\subsection*{Typedefs}
\begin{DoxyCompactItemize}
\item 
typedef struct \hyperlink{structtag__macroblock__info}{tag\_\-macroblock\_\-info} \hyperlink{_i_slice_8cpp_a70507a1942c7456e54a889c4ed5cb75a}{macroblock\_\-info}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_i_slice_8cpp_a62bde0c28d855f00622a319f1be6dfd2}{require\_\-data\_\-decode\_\-I} (\hyperlink{struct_coding_pict_info}{CodingPictInfo} $\ast$cpi, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$list, \hyperlink{structpredict_info}{predictInfo} $\ast$plist, \hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32\_\-t} cur\_\-r, \hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32\_\-t} cur\_\-c)
\item 
void \hyperlink{_i_slice_8cpp_a9aec4e077652c6d1dba0479062157d21}{save\_\-data} (\hyperlink{struct_coding_pict_info}{CodingPictInfo} $\ast$cpi, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$dlist, \hyperlink{structpredict_info}{predictInfo} $\ast$plist, \hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32\_\-t} cur\_\-r, \hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32\_\-t} cur\_\-c)
\item 
void \hyperlink{_i_slice_8cpp_a23c43acab8cba26c6a4938028715f817}{process\_\-data\_\-decode\_\-I} (\hyperlink{struct_coding_pict_info}{CodingPictInfo} $\ast$cpi, \hyperlink{structmacroblockdata}{macroblockdata} $\ast$dlist, \hyperlink{structpredict_info}{predictInfo} $\ast$plist, \hyperlink{structmacroblock_info}{macroblockInfo} $\ast$mlist)
\item 
\hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32\_\-t} \hyperlink{_i_slice_8cpp_a7072192e2d086f088b2834bb5a5482b2}{is\_\-data\_\-required} (\hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32\_\-t} idx)
\item 
\hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32\_\-t} \hyperlink{_i_slice_8cpp_a8c4133d377a95f877dde9a1ca07534f6}{is\_\-data\_\-saved} (\hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32\_\-t} idx)
\item 
int \hyperlink{_i_slice_8cpp_a582f95d234a6f0902b8df497f3712c01}{macroblock\_\-processor\_\-I} (void $\ast$param)
\item 
void \hyperlink{_i_slice_8cpp_a3d8b6dcdaff59baf9c7b27ae426f0a5a}{ISliceDecode} (\hyperlink{struct_coding_pict_info}{CodingPictInfo} $\ast$cpi, \hyperlink{struct_bitstream}{Bitstream} $\ast$bs)
\end{DoxyCompactItemize}


\subsection{Typedef Documentation}
\hypertarget{_i_slice_8cpp_a70507a1942c7456e54a889c4ed5cb75a}{
\index{ISlice.cpp@{ISlice.cpp}!macroblock\_\-info@{macroblock\_\-info}}
\index{macroblock\_\-info@{macroblock\_\-info}!ISlice.cpp@{ISlice.cpp}}
\subsubsection[{macroblock\_\-info}]{\setlength{\rightskip}{0pt plus 5cm}typedef struct {\bf tag\_\-macroblock\_\-info}  {\bf macroblock\_\-info}}}
\label{_i_slice_8cpp_a70507a1942c7456e54a889c4ed5cb75a}


\subsection{Function Documentation}
\hypertarget{_i_slice_8cpp_a7072192e2d086f088b2834bb5a5482b2}{
\index{ISlice.cpp@{ISlice.cpp}!is\_\-data\_\-required@{is\_\-data\_\-required}}
\index{is\_\-data\_\-required@{is\_\-data\_\-required}!ISlice.cpp@{ISlice.cpp}}
\subsubsection[{is\_\-data\_\-required}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int32\_\-t} is\_\-data\_\-required ({\bf int32\_\-t} {\em idx})}}
\label{_i_slice_8cpp_a7072192e2d086f088b2834bb5a5482b2}




\begin{footnotesize}\begin{alltt}
00147 \{
00148         \textcolor{keywordflow}{return} 1;
00149 \}
\end{alltt}\end{footnotesize}


\hypertarget{_i_slice_8cpp_a8c4133d377a95f877dde9a1ca07534f6}{
\index{ISlice.cpp@{ISlice.cpp}!is\_\-data\_\-saved@{is\_\-data\_\-saved}}
\index{is\_\-data\_\-saved@{is\_\-data\_\-saved}!ISlice.cpp@{ISlice.cpp}}
\subsubsection[{is\_\-data\_\-saved}]{\setlength{\rightskip}{0pt plus 5cm}{\bf int32\_\-t} is\_\-data\_\-saved ({\bf int32\_\-t} {\em idx})}}
\label{_i_slice_8cpp_a8c4133d377a95f877dde9a1ca07534f6}




\begin{footnotesize}\begin{alltt}
00152 \{
00153         \textcolor{keywordflow}{return} 1;
00154 \}
\end{alltt}\end{footnotesize}


\hypertarget{_i_slice_8cpp_a3d8b6dcdaff59baf9c7b27ae426f0a5a}{
\index{ISlice.cpp@{ISlice.cpp}!ISliceDecode@{ISliceDecode}}
\index{ISliceDecode@{ISliceDecode}!ISlice.cpp@{ISlice.cpp}}
\subsubsection[{ISliceDecode}]{\setlength{\rightskip}{0pt plus 5cm}void ISliceDecode ({\bf CodingPictInfo} $\ast$ {\em cpi}, \/  {\bf Bitstream} $\ast$ {\em bs})}}
\label{_i_slice_8cpp_a3d8b6dcdaff59baf9c7b27ae426f0a5a}




\begin{footnotesize}\begin{alltt}
00187 \{
00188         \textcolor{keywordtype}{bool} isParallel = cpi->\hyperlink{struct_coding_pict_info_ab254953ed2b4e1de64f05eadbc825646}{MP} * \hyperlink{_common_8h_a3a7c35b14731007b6847c0d57ba23d68}{MB_E} > 1.0;
00189         \textcolor{keywordtype}{int} MBheight = cpi->\hyperlink{struct_coding_pict_info_aa6352dc53234c55d1a0c252c5b8d6141}{Size_Height} >> 4,
00190                 MBwidth = cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width} >> 4;
00191         \hyperlink{structmacroblock_info}{macroblockInfo} *mlist = \textcolor{keyword}{new} \hyperlink{structmacroblock_info}{macroblockInfo}[MBheight * MBwidth];
00192         memset(mlist, 0, \textcolor{keyword}{sizeof}(\hyperlink{structmacroblock_info}{macroblockInfo}) * MBheight * MBwidth);
00193         \hyperlink{structtag__macroblock__info}{macroblock_info} *mis = \textcolor{keyword}{new} \hyperlink{structtag__macroblock__info}{macroblock_info}[\textcolor{comment}{/*ConfigureSlave::PARALLEL\_SIZ
      E*/}cpi->\hyperlink{struct_coding_pict_info_ab254953ed2b4e1de64f05eadbc825646}{MP} + 1];
00194         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i <= \textcolor{comment}{/*ConfigureSlave::PARALLEL\_SIZE*/}cpi->\hyperlink{struct_coding_pict_info_ab254953ed2b4e1de64f05eadbc825646}{MP}; ++i)
00195         \{
00196                 mis[i].\hyperlink{structtag__macroblock__info_ae7a0c6b68c7cbc0ffb1a82799eb386ef}{cpi} = cpi;
00197                 mis[i].\hyperlink{structtag__macroblock__info_affbe6dcc30999a24be78a7deb7a0e78b}{allow} = MBwidth;
00198                 mis[i].\hyperlink{structtag__macroblock__info_ae6d03b766139a5abf281211e48c8d49b}{next} = mis+i+1;
00199         \}
00200         mis[\textcolor{comment}{/*ConfigureSlave::PARALLEL\_SIZE*/}cpi->\hyperlink{struct_coding_pict_info_ab254953ed2b4e1de64f05eadbc825646}{MP}].\hyperlink{structtag__macroblock__info_ae6d03b766139a5abf281211e48c8d49b}{next} = mis;
00201 
00202         \hyperlink{structtag__cavlc__ref__list}{cavlc_ref_list} ref\_list;
00203         \hyperlink{structtag__cavlc__ref}{cavlc_ref} *topRef = \textcolor{keyword}{new} \hyperlink{structtag__cavlc__ref}{cavlc_ref}[MBwidth * 4 + 5];
00204         memset(topRef, 0, \textcolor{keyword}{sizeof}(\hyperlink{structtag__cavlc__ref}{cavlc_ref}) * (MBwidth * 4 + 5));
00205         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < MBwidth * 4 + 5; ++i)
00206         \{
00207                 topRef[i].\hyperlink{structtag__cavlc__ref_a4fc396cd8d03fbd50466ff12a4785529}{coeff} = 0x40;
00208                 topRef[i].\hyperlink{structtag__cavlc__ref_a38397a4aa7f4f450d2bed25146783b22}{coeffC} = 0x40;
00209                 topRef[i].\hyperlink{structtag__cavlc__ref_a76c8b0c75a3a13a59196c89cf919766f}{imode} = 0x40;
00210         \}
00211         ref\_list.\hyperlink{structtag__cavlc__ref__list_a854c970004394513901757cc3dcb65e5}{left} = \textcolor{keyword}{new} \hyperlink{structtag__cavlc__ref}{cavlc_ref}[4];
00212 
00213         \textcolor{keywordtype}{int} cQp = cpi->\hyperlink{struct_coding_pict_info_a6e808cdf552c3a18da4b75f4d0c35c28}{baseQP};
00214         \textcolor{keywordtype}{int} iii = 0;
00215         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} r = 0; r < MBheight; ++r)
00216         \{
00217                 memset(ref\_list.\hyperlink{structtag__cavlc__ref__list_a854c970004394513901757cc3dcb65e5}{left}, 0, \textcolor{keyword}{sizeof}(\hyperlink{structtag__cavlc__ref}{cavlc_ref}) * 4);
00218                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 4; ++j)
00219                 \{
00220                         ref\_list.\hyperlink{structtag__cavlc__ref__list_a854c970004394513901757cc3dcb65e5}{left}[j].\hyperlink{structtag__cavlc__ref_a4fc396cd8d03fbd50466ff12a4785529}{coeff} = 0x40;
00221                         ref\_list.\hyperlink{structtag__cavlc__ref__list_a854c970004394513901757cc3dcb65e5}{left}[j].\hyperlink{structtag__cavlc__ref_a38397a4aa7f4f450d2bed25146783b22}{coeffC} = 0x40;
00222                         ref\_list.\hyperlink{structtag__cavlc__ref__list_a854c970004394513901757cc3dcb65e5}{left}[j].\hyperlink{structtag__cavlc__ref_a76c8b0c75a3a13a59196c89cf919766f}{imode} = 0x40;
00223                 \}
00224                 ref\_list.\hyperlink{structtag__cavlc__ref__list_af93b34de26224281e33b951333a665c7}{top} = topRef + 1;
00225                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} c = 0; c < MBwidth; ++c)
00226                 \{
00227                         memset(&mlist[iii], 0, \textcolor{keyword}{sizeof}(mlist[iii]));
00228                         mlist[iii].\hyperlink{structmacroblock_info_af09f9c522a04fe712528e6db6a696866}{mbtype} = 2;
00229                         mlist[iii].\hyperlink{structmacroblock_info_ae46d0fbf2f0e11fc965a60845db47065}{mbR} = r;
00230                         mlist[iii].\hyperlink{structmacroblock_info_ab6270e45676c0f84c1450cf90a84df52}{mbC} = c;
00231                         \hyperlink{_i_c_a_v_l_c_8cpp_a5ca95f08673d3dcfd97990a11501c6da}{macroblock_read_cavlc_I_slice}(bs, &mlist[iii], &ref\_list)
      ;
00232                         cQp += mlist[iii].\hyperlink{structmacroblock_info_a732ef45ea0429985a3833fc7a93bf9fd}{qp_delta};
00233                         mlist[iii].\hyperlink{structmacroblock_info_a732ef45ea0429985a3833fc7a93bf9fd}{qp_delta} = cQp - cpi->\hyperlink{struct_coding_pict_info_a6e808cdf552c3a18da4b75f4d0c35c28}{baseQP};
00234                         ++iii;
00235                         ref\_list.\hyperlink{structtag__cavlc__ref__list_af93b34de26224281e33b951333a665c7}{top} += 4;
00236                 \}
00237         \}
00238         \textcolor{keywordtype}{int} p = 0, p1 = p + 1, p2 = p1 + 1;
00239         \textcolor{keywordflow}{if} (\textcolor{comment}{/*ConfigureSlave::PARALLEL\_SIZE*/}cpi->\hyperlink{struct_coding_pict_info_ab254953ed2b4e1de64f05eadbc825646}{MP} == 1)
00240                 p2 = 0;
00241         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < MBheight; ++i)
00242         \{
00243                 \textcolor{keywordflow}{while} (mis[p2].allow != MBwidth)
00244                         Sleep(1);
00245                 mis[p1].\hyperlink{structtag__macroblock__info_affbe6dcc30999a24be78a7deb7a0e78b}{allow} = 0;
00246                 mis[p].\hyperlink{structtag__macroblock__info_a0431b0abc33b349505f0b83fd1537473}{row} = i;
00247                 mis[p].\hyperlink{structtag__macroblock__info_a150f68ca8a911ab2443199821f7b97e5}{mblist} = mlist + i * MBwidth;
00248                 \textcolor{keywordflow}{if} (\textcolor{comment}{/*ConfigureSlave::NO\_PARALLEL*/}!isParallel)
00249                         \hyperlink{_i_slice_8cpp_a582f95d234a6f0902b8df497f3712c01}{macroblock_processor_I}(mis+p);
00250                 \textcolor{keywordflow}{else}
00251                         MVCCreateMasterThread(\hyperlink{_i_slice_8cpp_a582f95d234a6f0902b8df497f3712c01}{macroblock_processor_I}, mis+p);
00252                 p = p1; p1 = p2;
00253                 \textcolor{keywordflow}{if} (p2==\textcolor{comment}{/*ConfigureSlave::PARALLEL\_SIZE*/}cpi->\hyperlink{struct_coding_pict_info_ab254953ed2b4e1de64f05eadbc825646}{MP})
00254                         p2 = 0;
00255                 \textcolor{keywordflow}{else}
00256                         ++p2;
00257         \}
00258         \textcolor{keywordflow}{while} (mis[p].allow != MBwidth)
00259                 Sleep(1);
00260         \textcolor{keywordflow}{if} (cpi->\hyperlink{struct_coding_pict_info_ad85dae4751165ea3cbb8f7b8c6e61dc3}{timeId}==8 && cpi->\hyperlink{struct_coding_pict_info_a987595091bfba91b3166b04bca988697}{viewId}==0)
00261         \{
00262                 printf(\textcolor{stringliteral}{"============Before============\(\backslash\)n"});
00263                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ii = 0; ii < MBheight; ++ii)
00264                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} jj = 0; jj < MBwidth; ++jj)
00265                         \{
00266                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; ++i)
00267                                 \{
00268                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 16; ++j)
00269                                         \{
00270                                                 printf(\textcolor{stringliteral}{"%4d"}, cpi->\hyperlink{struct_coding_pict_info_a62aee8cc8c9cac725d4f44a19ddc8c2b}{lumaStart}[(ii*
      16+i)*cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width}+jj*16+j]);
00271                                         \}
00272                                         printf(\textcolor{stringliteral}{"\(\backslash\)n"});
00273                                 \}
00274                                 printf(\textcolor{stringliteral}{"\(\backslash\)n"});
00275                         \}
00276                 printf(\textcolor{stringliteral}{"===Before===\(\backslash\)n"});
00277                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ii = 0; ii < MBheight; ++ii)
00278                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} jj = 0; jj < MBwidth; ++jj)
00279                         \{
00280                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00281                                 \{
00282                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00283                                         \{
00284                                                 printf(\textcolor{stringliteral}{"%4d"}, cpi->\hyperlink{struct_coding_pict_info_a103a3180ba57db0bd984a53f0668b70b}{chromaUStart}[(
      ii*8+i)*cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width}/2+jj*8+j]);
00285                                         \}
00286                                         printf(\textcolor{stringliteral}{"\(\backslash\)n"});
00287                                 \}
00288                                 printf(\textcolor{stringliteral}{"\(\backslash\)n"});
00289                         \}
00290                         \textcolor{comment}{/*}
00291 \textcolor{comment}{                for (int ii = 0; ii < MBheight; ++ii)}
00292 \textcolor{comment}{                        for (int jj = 0; jj < MBwidth; ++jj)}
00293 \textcolor{comment}{                        \{}
00294 \textcolor{comment}{                                for (int i = 0; i < 8; ++i)}
00295 \textcolor{comment}{                                \{}
00296 \textcolor{comment}{                                        for (int j = 0; j < 8; ++j)}
00297 \textcolor{comment}{                                        \{}
00298 \textcolor{comment}{                                                printf("%4d", cpi->chromaVStart[(
      ii*8+i)*cpi->Size\_Width/2+jj*8+j]);}
00299 \textcolor{comment}{                                        \}}
00300 \textcolor{comment}{                                        printf("\(\backslash\)n");}
00301 \textcolor{comment}{                                \}}
00302 \textcolor{comment}{                                printf("\(\backslash\)n");}
00303 \textcolor{comment}{                        \}}
00304 \textcolor{comment}{                        */}
00305                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < MBwidth * MBheight; ++i)
00306                 \{
00307                         \hyperlink{_loop_filter_8cpp_a299f516a75a0efad87a05dfbb35c9b41}{FilterMB}(cpi, mlist, i);
00308                 \}
00309                 printf(\textcolor{stringliteral}{"===============After==============\(\backslash\)n"});
00310                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ii = 0; ii < MBheight; ++ii)
00311                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} jj = 0; jj < MBwidth; ++jj)
00312                         \{
00313                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; ++i)
00314                                 \{
00315                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 16; ++j)
00316                                         \{
00317                                                 printf(\textcolor{stringliteral}{"%4d"}, cpi->\hyperlink{struct_coding_pict_info_a62aee8cc8c9cac725d4f44a19ddc8c2b}{lumaStart}[(ii*
      16+i)*cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width}+jj*16+j]);
00318                                         \}
00319                                         printf(\textcolor{stringliteral}{"\(\backslash\)n"});
00320                                 \}
00321                                 printf(\textcolor{stringliteral}{"\(\backslash\)n"});
00322                         \}
00323                 printf(\textcolor{stringliteral}{"===After===\(\backslash\)n"});
00324                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} ii = 0; ii < MBheight; ++ii)
00325                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} jj = 0; jj < MBwidth; ++jj)
00326                         \{
00327                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00328                                 \{
00329                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00330                                         \{
00331                                                 printf(\textcolor{stringliteral}{"%4d"}, cpi->\hyperlink{struct_coding_pict_info_a103a3180ba57db0bd984a53f0668b70b}{chromaUStart}[(
      ii*8+i)*cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width}/2+jj*8+j]);
00332                                         \}
00333                                         printf(\textcolor{stringliteral}{"\(\backslash\)n"});
00334                                 \}
00335                                 printf(\textcolor{stringliteral}{"\(\backslash\)n"});
00336                         \}
00337                         \textcolor{comment}{/*}
00338 \textcolor{comment}{                for (int ii = 0; ii < MBheight; ++ii)}
00339 \textcolor{comment}{                        for (int jj = 0; jj < MBwidth; ++jj)}
00340 \textcolor{comment}{                        \{}
00341 \textcolor{comment}{                                for (int i = 0; i < 8; ++i)}
00342 \textcolor{comment}{                                \{}
00343 \textcolor{comment}{                                        for (int j = 0; j < 8; ++j)}
00344 \textcolor{comment}{                                        \{}
00345 \textcolor{comment}{                                                printf("%4d", cpi->chromaVStart[(
      ii*8+i)*cpi->Size\_Width/2+jj*8+j]);}
00346 \textcolor{comment}{                                        \}}
00347 \textcolor{comment}{                                        printf("\(\backslash\)n");}
00348 \textcolor{comment}{                                \}}
00349 \textcolor{comment}{                                printf("\(\backslash\)n");}
00350 \textcolor{comment}{                        \}}
00351 \textcolor{comment}{                        */}
00352                 exit(0);
00353         \}
00354         \textcolor{keywordflow}{else}
00355         \{
00356                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < MBwidth * MBheight; ++i)
00357                 \{
00358                         \hyperlink{_loop_filter_8cpp_a299f516a75a0efad87a05dfbb35c9b41}{FilterMB}(cpi, mlist, i);
00359                 \}
00360         \}
00361         \textcolor{keyword}{delete} []topRef;
00362         \textcolor{keyword}{delete} []mis;
00363         \textcolor{keyword}{delete} []mlist;
00364 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_i_slice_8cpp_a3d8b6dcdaff59baf9c7b27ae426f0a5a_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=172pt]{_i_slice_8cpp_a3d8b6dcdaff59baf9c7b27ae426f0a5a_icgraph}
\end{center}
\end{figure}


\hypertarget{_i_slice_8cpp_a582f95d234a6f0902b8df497f3712c01}{
\index{ISlice.cpp@{ISlice.cpp}!macroblock\_\-processor\_\-I@{macroblock\_\-processor\_\-I}}
\index{macroblock\_\-processor\_\-I@{macroblock\_\-processor\_\-I}!ISlice.cpp@{ISlice.cpp}}
\subsubsection[{macroblock\_\-processor\_\-I}]{\setlength{\rightskip}{0pt plus 5cm}int macroblock\_\-processor\_\-I (void $\ast$ {\em param})}}
\label{_i_slice_8cpp_a582f95d234a6f0902b8df497f3712c01}




\begin{footnotesize}\begin{alltt}
00167 \{
00168         \hyperlink{structtag__macroblock__info}{macroblock_info} *mi = (\hyperlink{structtag__macroblock__info}{macroblock_info} *)param;
00169         \hyperlink{structmacroblockdata}{macroblockdata} datalist;
00170         \hyperlink{structpredict_info}{predictInfo} predlist;
00171         \textcolor{keywordtype}{int} row = mi->\hyperlink{structtag__macroblock__info_a0431b0abc33b349505f0b83fd1537473}{row};
00172         \textcolor{keywordtype}{int} MBwidth = mi->\hyperlink{structtag__macroblock__info_ae7a0c6b68c7cbc0ffb1a82799eb386ef}{cpi}->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width} >> 4;
00173         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < MBwidth; ++i)
00174         \{
00175                 \textcolor{keywordflow}{while} (mi->\hyperlink{structtag__macroblock__info_affbe6dcc30999a24be78a7deb7a0e78b}{allow}<=i)
00176                         Sleep(1);
00177                 \hyperlink{_i_slice_8cpp_a62bde0c28d855f00622a319f1be6dfd2}{require_data_decode_I}(mi->\hyperlink{structtag__macroblock__info_ae7a0c6b68c7cbc0ffb1a82799eb386ef}{cpi}, &datalist, &predlist, row, i);
00178                 \hyperlink{_i_slice_8cpp_a23c43acab8cba26c6a4938028715f817}{process_data_decode_I}(mi->\hyperlink{structtag__macroblock__info_ae7a0c6b68c7cbc0ffb1a82799eb386ef}{cpi}, &datalist, &predlist, mi->\hyperlink{structtag__macroblock__info_a150f68ca8a911ab2443199821f7b97e5}{mblist}+i
      );
00179                 \hyperlink{_i_slice_8cpp_a9aec4e077652c6d1dba0479062157d21}{save_data}(mi->\hyperlink{structtag__macroblock__info_ae7a0c6b68c7cbc0ffb1a82799eb386ef}{cpi}, &datalist, &predlist, row, i);
00180                 mi->\hyperlink{structtag__macroblock__info_ae6d03b766139a5abf281211e48c8d49b}{next}->\hyperlink{structtag__macroblock__info_affbe6dcc30999a24be78a7deb7a0e78b}{allow} = i - 1;
00181         \}
00182         mi->\hyperlink{structtag__macroblock__info_ae6d03b766139a5abf281211e48c8d49b}{next}->\hyperlink{structtag__macroblock__info_affbe6dcc30999a24be78a7deb7a0e78b}{allow} = MBwidth;
00183         \textcolor{keywordflow}{return} 0;
00184 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=409pt]{_i_slice_8cpp_a582f95d234a6f0902b8df497f3712c01_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=251pt]{_i_slice_8cpp_a582f95d234a6f0902b8df497f3712c01_icgraph}
\end{center}
\end{figure}


\hypertarget{_i_slice_8cpp_a23c43acab8cba26c6a4938028715f817}{
\index{ISlice.cpp@{ISlice.cpp}!process\_\-data\_\-decode\_\-I@{process\_\-data\_\-decode\_\-I}}
\index{process\_\-data\_\-decode\_\-I@{process\_\-data\_\-decode\_\-I}!ISlice.cpp@{ISlice.cpp}}
\subsubsection[{process\_\-data\_\-decode\_\-I}]{\setlength{\rightskip}{0pt plus 5cm}void process\_\-data\_\-decode\_\-I ({\bf CodingPictInfo} $\ast$ {\em cpi}, \/  {\bf macroblockdata} $\ast$ {\em dlist}, \/  {\bf predictInfo} $\ast$ {\em plist}, \/  {\bf macroblockInfo} $\ast$ {\em mlist})}}
\label{_i_slice_8cpp_a23c43acab8cba26c6a4938028715f817}




\begin{footnotesize}\begin{alltt}
00119 \{
00120         \textcolor{comment}{// TODO: Àî}
00121         \hyperlink{_debug_8h_a3f7e58a01a8beb987f565ac1a304708c}{DEBUGBLK}(9, (\textcolor{stringliteral}{"process\_data\_decode"}));
00122 
00123         \hyperlink{structmacroblockdata}{macroblockdata} pred0;
00124 
00125         \hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32_t} i = 0;
00126         memset(&pred0, 128, \textcolor{keyword}{sizeof}(pred0));
00127         i = 0;
00128         \textcolor{keywordflow}{if} (mlist[i].mode\_i16x16 == \hyperlink{_consts4_standard_8h_adf764cbdea00d65edcd07bb9953ad2b7a9086e22a5020a2e013c6eca452ba49e8}{Intra_16x16_DC})
00129         \{
00130                 \textcolor{keywordflow}{if} (plist[i].hasLeft && plist[i].hasTop) ;      \textcolor{keywordflow}{else}
00131                 \textcolor{keywordflow}{if} (plist[i].hasLeft)   mlist[i].\hyperlink{structmacroblock_info_a56fac1ac121007a216cd538adc034a16}{mode_i16x16} = 
      \hyperlink{_consts4_standard_8h_adf764cbdea00d65edcd07bb9953ad2b7acc79559af1945306d7487c1567f62d0d}{Intra_16x16_DCLEFT};     \textcolor{keywordflow}{else}
00132                 \textcolor{keywordflow}{if} (plist[i].hasTop)    mlist[i].\hyperlink{structmacroblock_info_a56fac1ac121007a216cd538adc034a16}{mode_i16x16} = \hyperlink{_consts4_standard_8h_adf764cbdea00d65edcd07bb9953ad2b7abe756da4a19f91e01e4411713b34dd90}{Intra_16x16_DCTOP};
              \textcolor{keywordflow}{else}
00133                         mlist[i].\hyperlink{structmacroblock_info_a56fac1ac121007a216cd538adc034a16}{mode_i16x16} = \hyperlink{_consts4_standard_8h_adf764cbdea00d65edcd07bb9953ad2b7a6174d509d5e37d9ae079c59383c193b2}{Intra_16x16_DC128};
00134         \}
00135         \textcolor{keywordflow}{if} (mlist[i].mode\_uv == \hyperlink{_consts4_standard_8h_a99fb83031ce9923c84392b4e92f956b5a646411ab4d2f5168b1d2900f8e0a9e0d}{Intra_8x8_DC})
00136         \{
00137                 \textcolor{keywordflow}{if} (plist[i].hasLeft && plist[i].hasTop) ;      \textcolor{keywordflow}{else}
00138                 \textcolor{keywordflow}{if} (plist[i].hasLeft)   mlist[i].\hyperlink{structmacroblock_info_a562426f4ab2f9cd93c95cff91faaa0f6}{mode_uv} = \hyperlink{_consts4_standard_8h_a99fb83031ce9923c84392b4e92f956b5a2fbf8eaefbd5828d5106e0974deb648e}{Intra_8x8_DCLEFT};    \textcolor{keywordflow}{e
      lse}
00139                 \textcolor{keywordflow}{if} (plist[i].hasTop)    mlist[i].\hyperlink{structmacroblock_info_a562426f4ab2f9cd93c95cff91faaa0f6}{mode_uv} = \hyperlink{_consts4_standard_8h_a99fb83031ce9923c84392b4e92f956b5a2789b4e28b9fef8837c8f2b867b80650}{Intra_8x8_DCTOP};     \textcolor{keywordflow}{e
      lse}
00140                         mlist[i].\hyperlink{structmacroblock_info_a562426f4ab2f9cd93c95cff91faaa0f6}{mode_uv} = \hyperlink{_consts4_standard_8h_a99fb83031ce9923c84392b4e92f956b5a3f5d49151d1a4cfeb047b96f8956753a}{Intra_8x8_DC128};
00141         \}
00142         \hyperlink{_i_macroblock_codec_8cpp_acaa2acf29de1293461dea9f2882931c5}{macroblockIntraDecode}(&dlist[i], cpi->\hyperlink{struct_coding_pict_info_a6e808cdf552c3a18da4b75f4d0c35c28}{baseQP} + mlist->\hyperlink{structmacroblock_info_a732ef45ea0429985a3833fc7a93bf9fd}{qp_delta}, 
      \hyperlink{_consts4_standard_8h_a764e5d7924eac5d10266946aa1d1c695}{QPLuma2Chroma}[cpi->\hyperlink{struct_coding_pict_info_a6e808cdf552c3a18da4b75f4d0c35c28}{baseQP} + mlist->\hyperlink{structmacroblock_info_a732ef45ea0429985a3833fc7a93bf9fd}{qp_delta}], &mlist[i], &plist[i]);
00143 
00144 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{_i_slice_8cpp_a23c43acab8cba26c6a4938028715f817_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=341pt]{_i_slice_8cpp_a23c43acab8cba26c6a4938028715f817_icgraph}
\end{center}
\end{figure}


\hypertarget{_i_slice_8cpp_a62bde0c28d855f00622a319f1be6dfd2}{
\index{ISlice.cpp@{ISlice.cpp}!require\_\-data\_\-decode\_\-I@{require\_\-data\_\-decode\_\-I}}
\index{require\_\-data\_\-decode\_\-I@{require\_\-data\_\-decode\_\-I}!ISlice.cpp@{ISlice.cpp}}
\subsubsection[{require\_\-data\_\-decode\_\-I}]{\setlength{\rightskip}{0pt plus 5cm}void require\_\-data\_\-decode\_\-I ({\bf CodingPictInfo} $\ast$ {\em cpi}, \/  {\bf macroblockdata} $\ast$ {\em list}, \/  {\bf predictInfo} $\ast$ {\em plist}, \/  {\bf int32\_\-t} {\em cur\_\-r}, \/  {\bf int32\_\-t} {\em cur\_\-c})}}
\label{_i_slice_8cpp_a62bde0c28d855f00622a319f1be6dfd2}




\begin{footnotesize}\begin{alltt}
00025 \{
00026         \hyperlink{_types_8h_a115ba3a1b24a8702355c5dbd61ce01e0}{int32_t} i = 0, j;
00027         \textcolor{keywordtype}{int} lumaStride = cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width},
00028         chromaStride = cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width} / 2,
00029         refMBt = 8 * 2,
00030         refStride = cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width} / 16 * refMBt;
00031         \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8_t} *luma = cpi->\hyperlink{struct_coding_pict_info_a62aee8cc8c9cac725d4f44a19ddc8c2b}{lumaStart} + lumaStride * cur\_r * 16 + cur\_c * 16,
00032         *chromaU = cpi->\hyperlink{struct_coding_pict_info_a103a3180ba57db0bd984a53f0668b70b}{chromaUStart} + lumaStride * cur\_r * 4 + cur\_c * 8,
00033         *chromaV = cpi->\hyperlink{struct_coding_pict_info_a7be3395b2a1e7f4b384421c2490dcfdc}{chromaVStart} + lumaStride * cur\_r * 4 + cur\_c * 8;
00034         \textcolor{keywordflow}{if} ((plist[i].hasLeft = (cur\_c>0)))
00035         \{
00036                 \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8_t} *luma\_p = luma - 1,
00037                         *chromaU\_p = chromaU - 1,
00038                         *chromaV\_p = chromaV - 1;
00039                 \textcolor{keywordflow}{for} (j = 0; j < 16; ++j)
00040                 \{
00041                         GetAndWait(&plist[i].left[j], luma\_p, 1);
00042                         luma\_p += lumaStride;
00043                 \}
00044                 \textcolor{keywordflow}{for} (j = 0; j < 8; ++j)
00045                 \{
00046                         GetAndWait(&plist[i].data\_u[8+j], chromaU\_p, 1);
00047                         GetAndWait(&plist[i].data\_v[8+j], chromaV\_p, 1);
00048                         chromaU\_p += chromaStride;
00049                         chromaV\_p += chromaStride;
00050                 \}
00051         \}
00052         \textcolor{comment}{// Top}
00053         \textcolor{keywordflow}{if} ((plist[i].hasTop = (cur\_r>0)))
00054         \{
00055                 \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8_t} *luma\_p = luma - lumaStride,
00056                         *chromaU\_p = chromaU - chromaStride,
00057                         *chromaV\_p = chromaV - chromaStride;
00058                 GetAndWait(plist[i].top, luma\_p, 24);
00059                 \textcolor{keywordflow}{if} ((cur\_c+1)*16==cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width})
00060                         memset(plist[i].top+16, plist[i].top[15], 8);
00061                 GetAndWait(plist[i].data\_u, chromaU\_p, 8);
00062                 GetAndWait(plist[i].data\_v, chromaV\_p, 8);
00063         \}
00064         \textcolor{comment}{// TopLeft}
00065         \textcolor{keywordflow}{if} (plist[i].hasLeft && plist[i].hasTop)
00066         \{
00067                 GetAndWait(&plist[i].topleft, luma - lumaStride - 1, 1);
00068                 GetAndWait(&plist[i].data\_u[16], chromaU - chromaStride - 1, 1);
00069                 GetAndWait(&plist[i].data\_v[16], chromaV - chromaStride - 1, 1);
00070         \}
00071         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (plist[i].hasTop)
00072         \{
00073                 plist[i].\hyperlink{structpredict_info_a2f363beeef9ca2f90a0db2259fc88f7b}{topleft} = plist[i].\hyperlink{structpredict_info_ab44f7aab3b6e76f7be44d5420f5f4407}{top}[0];
00074                 plist[i].\hyperlink{structpredict_info_a4bb62e14becc6e2eeac45bc8d6a66688}{data_u}[16] = plist[i].\hyperlink{structpredict_info_a4bb62e14becc6e2eeac45bc8d6a66688}{data_u}[0];
00075                 plist[i].\hyperlink{structpredict_info_ad302972bab20c3c3c87ce4a25efd17a3}{data_v}[16] = plist[i].\hyperlink{structpredict_info_ad302972bab20c3c3c87ce4a25efd17a3}{data_v}[0];
00076         \}
00077         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (plist[i].hasLeft)
00078         \{
00079                 plist[i].\hyperlink{structpredict_info_a2f363beeef9ca2f90a0db2259fc88f7b}{topleft} = plist[i].\hyperlink{structpredict_info_aaec86d32b8769dabe17f60051a792e19}{left}[0];
00080                 plist[i].\hyperlink{structpredict_info_a4bb62e14becc6e2eeac45bc8d6a66688}{data_u}[16] = plist[i].\hyperlink{structpredict_info_a4bb62e14becc6e2eeac45bc8d6a66688}{data_u}[8];
00081                 plist[i].\hyperlink{structpredict_info_ad302972bab20c3c3c87ce4a25efd17a3}{data_v}[16] = plist[i].\hyperlink{structpredict_info_ad302972bab20c3c3c87ce4a25efd17a3}{data_v}[8];
00082         \}
00083 \}
\end{alltt}\end{footnotesize}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=338pt]{_i_slice_8cpp_a62bde0c28d855f00622a319f1be6dfd2_icgraph}
\end{center}
\end{figure}


\hypertarget{_i_slice_8cpp_a9aec4e077652c6d1dba0479062157d21}{
\index{ISlice.cpp@{ISlice.cpp}!save\_\-data@{save\_\-data}}
\index{save\_\-data@{save\_\-data}!ISlice.cpp@{ISlice.cpp}}
\subsubsection[{save\_\-data}]{\setlength{\rightskip}{0pt plus 5cm}void save\_\-data ({\bf CodingPictInfo} $\ast$ {\em cpi}, \/  {\bf macroblockdata} $\ast$ {\em dlist}, \/  {\bf predictInfo} $\ast$ {\em plist}, \/  {\bf int32\_\-t} {\em cur\_\-r}, \/  {\bf int32\_\-t} {\em cur\_\-c})}}
\label{_i_slice_8cpp_a9aec4e077652c6d1dba0479062157d21}




\begin{footnotesize}\begin{alltt}
00086 \{
00087         \textcolor{comment}{//int32\_t i = 0, j;}
00088         \textcolor{keywordtype}{int} lumaStride = cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width},
00089                 chromaStride = cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width} / 2,
00090                 refMBt = \textcolor{keyword}{sizeof}(\hyperlink{structref_vector}{refVector}),
00091                 refStride = cpi->\hyperlink{struct_coding_pict_info_afeeb373571d44e64d473524e6127f3f7}{Size_Width} * 2 * refMBt;
00092         \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8_t} *luma = cpi->\hyperlink{struct_coding_pict_info_a62aee8cc8c9cac725d4f44a19ddc8c2b}{lumaStart} + lumaStride * cur\_r * 16 + cur\_c * 16,
00093                 *chromaU = cpi->\hyperlink{struct_coding_pict_info_a103a3180ba57db0bd984a53f0668b70b}{chromaUStart} + lumaStride * cur\_r * 4 + cur\_c * 8
      ,
00094                 *chromaV = cpi->\hyperlink{struct_coding_pict_info_a7be3395b2a1e7f4b384421c2490dcfdc}{chromaVStart} + lumaStride * cur\_r * 4 + cur\_c * 8
      ,
00095                 *ref = cpi->\hyperlink{struct_coding_pict_info_aa49520dd613a44185d6a41af8992d66c}{refVec} + refStride * cur\_r + cur\_c * 32 * refMBt;
00096         for (\textcolor{keywordtype}{int} j = 0; j < 16; ++j)
00097         \{
00098                 PutAndWait(dlist[0].y[j], luma, \textcolor{keyword}{sizeof}(dlist[0].y[j]));
00099                 luma += lumaStride;
00100         \}
00101         \hyperlink{_debug_8h_aa184ead4583be424a256b0ee06fea736}{DEBUGINFP}(4, (\textcolor{stringliteral}{"chroma\(\backslash\)n"}));
00102         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00103         \{
00104                 PutAndWait(dlist[0].uv[0][j], chromaU, \textcolor{keyword}{sizeof}(dlist[0].uv[0][j]))
      ;
00105                 PutAndWait(dlist[0].uv[1][j], chromaV, \textcolor{keyword}{sizeof}(dlist[0].uv[1][j]))
      ;
00106                 chromaU += chromaStride;
00107                 chromaV += chromaStride;
00108         \}
00109         \hyperlink{structref_vector}{refVector} *refs = (\hyperlink{structref_vector}{refVector}*)ref;
00110         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 32; ++i)
00111         \{
00112                 refs[i].\hyperlink{structref_vector_a87a1d38b9e235b983b82abd3a0eb47ab}{refno} = -1;
00113                 refs[i].\hyperlink{structref_vector_adeb9dca3f08b25112b9f6bccb5002f48}{x} = 0x2000;
00114                 refs[i].\hyperlink{structref_vector_a899825821ce74c5622ea369e32dcf67c}{y} = 0x2000;
00115         \}
00116 \}
\end{alltt}\end{footnotesize}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=299pt]{_i_slice_8cpp_a9aec4e077652c6d1dba0479062157d21_icgraph}
\end{center}
\end{figure}


