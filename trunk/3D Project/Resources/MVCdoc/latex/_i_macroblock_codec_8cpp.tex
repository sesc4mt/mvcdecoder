\hypertarget{_i_macroblock_codec_8cpp}{
\section{MVCDecoder/Codec/IFrame/IMacroblockCodec.cpp File Reference}
\label{_i_macroblock_codec_8cpp}\index{MVCDecoder/Codec/IFrame/IMacroblockCodec.cpp@{MVCDecoder/Codec/IFrame/IMacroblockCodec.cpp}}
}
{\ttfamily \#include \char`\"{}IMacroblockCodec.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Common.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/DCTTransform.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/Quantisation.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/Scanner.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/IFrame/IPredict.h\char`\"{}}\par
{\ttfamily \#include \char`\"{}Codec/Consts4Standard.h\char`\"{}}\par
Include dependency graph for IMacroblockCodec.cpp:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{_i_macroblock_codec_8cpp__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=151pt]{_i_macroblock_codec_8cpp__dep__incl}
\end{center}
\end{figure}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \hyperlink{_i_macroblock_codec_8cpp_a3bb69edd67d7438ffa2148822898e335}{macroblockIntraDecode\_\-y} (\hyperlink{structmacroblockdata}{pmacroblockdata} dt, int Qp, \hyperlink{structpredict_info}{predictInfo} $\ast$pinfo, \hyperlink{structmacroblock_info}{pmacroblockInfo} mlist)
\item 
void \hyperlink{_i_macroblock_codec_8cpp_a0d5a08323fa05b03ffbebb448898663e}{macroblockIntraDecode\_\-uv} (\hyperlink{structmacroblockdata}{pmacroblockdata} dt, int Qp\_\-uv, \hyperlink{structpredict_info}{predictInfo} $\ast$pinfo, \hyperlink{structmacroblock_info}{pmacroblockInfo} mlist)
\item 
void \hyperlink{_i_macroblock_codec_8cpp_acaa2acf29de1293461dea9f2882931c5}{macroblockIntraDecode} (\hyperlink{structmacroblockdata}{pmacroblockdata} dt, int Qp\_\-y, int Qp\_\-uv, \hyperlink{structmacroblock_info}{pmacroblockInfo} rst, \hyperlink{structpredict_info}{predictInfo} $\ast$plist)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const int \hyperlink{_i_macroblock_codec_8cpp_ae22bb3624a8e7a421b4e8008720d67a5}{LUMA\_\-INDEX} \mbox{[}16\mbox{]} = \{0, 1, 4, 5, 2, 3, 6, 7, 8, 9, 12, 13, 10, 11, 14, 15\}
\item 
const int \hyperlink{_i_macroblock_codec_8cpp_a12d5120842ae04b4f2743ad6b5fc6f74}{LUMA\_\-INDEX\_\-INV} \mbox{[}16\mbox{]} = \{0, 1, 4, 5, 2, 3, 6, 7, 8, 9, 12, 13, 10, 11, 14, 15\}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{_i_macroblock_codec_8cpp_acaa2acf29de1293461dea9f2882931c5}{
\index{IMacroblockCodec.cpp@{IMacroblockCodec.cpp}!macroblockIntraDecode@{macroblockIntraDecode}}
\index{macroblockIntraDecode@{macroblockIntraDecode}!IMacroblockCodec.cpp@{IMacroblockCodec.cpp}}
\subsubsection[{macroblockIntraDecode}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockIntraDecode ({\bf pmacroblockdata} {\em dt}, \/  int {\em Qp\_\-y}, \/  int {\em Qp\_\-uv}, \/  {\bf pmacroblockInfo} {\em rst}, \/  {\bf predictInfo} $\ast$ {\em plist})}}
\label{_i_macroblock_codec_8cpp_acaa2acf29de1293461dea9f2882931c5}




\begin{footnotesize}\begin{alltt}
00294 \{
00295         \hyperlink{_i_macroblock_codec_8cpp_a3bb69edd67d7438ffa2148822898e335}{macroblockIntraDecode_y}(dt, Qp\_y, plist, rst);
00296         \hyperlink{_i_macroblock_codec_8cpp_a0d5a08323fa05b03ffbebb448898663e}{macroblockIntraDecode_uv}(dt, Qp\_uv, plist, rst);
00297 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=252pt]{_i_macroblock_codec_8cpp_acaa2acf29de1293461dea9f2882931c5_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=419pt]{_i_macroblock_codec_8cpp_acaa2acf29de1293461dea9f2882931c5_icgraph}
\end{center}
\end{figure}


\hypertarget{_i_macroblock_codec_8cpp_a0d5a08323fa05b03ffbebb448898663e}{
\index{IMacroblockCodec.cpp@{IMacroblockCodec.cpp}!macroblockIntraDecode\_\-uv@{macroblockIntraDecode\_\-uv}}
\index{macroblockIntraDecode\_\-uv@{macroblockIntraDecode\_\-uv}!IMacroblockCodec.cpp@{IMacroblockCodec.cpp}}
\subsubsection[{macroblockIntraDecode\_\-uv}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockIntraDecode\_\-uv ({\bf pmacroblockdata} {\em dt}, \/  int {\em Qp\_\-uv}, \/  {\bf predictInfo} $\ast$ {\em pinfo}, \/  {\bf pmacroblockInfo} {\em mlist})}}
\label{_i_macroblock_codec_8cpp_a0d5a08323fa05b03ffbebb448898663e}




\begin{footnotesize}\begin{alltt}
00257 \{
00258         \hyperlink{_types_8h_ae615613535a2b2445773922f5d45a861}{int16_t} udct[4][4][4];
00259         \hyperlink{_types_8h_ae615613535a2b2445773922f5d45a861}{int16_t} udct\_h[2][2];
00260 
00261         \hyperlink{structmacroblockdata}{macroblockdata} pred;
00262         memset(&pred, 0, \textcolor{keyword}{sizeof}(pred));
00263         \hyperlink{_i_predict_8cpp_a0988f72eec8591d5de83982c52e2b539}{do_8x8_chroma_prediction}(pinfo->\hyperlink{structpredict_info_a4bb62e14becc6e2eeac45bc8d6a66688}{data_u}, pred.\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[0], mlist->\hyperlink{structmacroblock_info_a562426f4ab2f9cd93c95cff91faaa0f6}{mode_uv});
00264         \hyperlink{_i_predict_8cpp_a0988f72eec8591d5de83982c52e2b539}{do_8x8_chroma_prediction}(pinfo->\hyperlink{structpredict_info_ad302972bab20c3c3c87ce4a25efd17a3}{data_v}, pred.\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[1], mlist->\hyperlink{structmacroblock_info_a562426f4ab2f9cd93c95cff91faaa0f6}{mode_uv});
00265         \textcolor{keywordtype}{int} l, i, j, k;
00266         \textcolor{keywordtype}{int} x, y;
00267         \textcolor{keywordflow}{for}(l = 0 ; l < 2 ; l ++)
00268         \{
00269                 \textcolor{keywordflow}{for}(i = 0 ; i < 4 ; i ++)
00270                         \hyperlink{_scanner_8h_a368d4bb8bcbc27ebecc3939c468dbcff}{unscan_zig_4x4}(mlist->\hyperlink{structmacroblock_info_a01c5c766f5445434369110a34cd1594e}{dct_uv_z}[l][i], udct[i][0]);
00271                 \hyperlink{_scanner_8h_aaa0324e6a8196220003838250cc45e75}{unscan_zig_2x2}(mlist->\hyperlink{structmacroblock_info_a973346c837d8cf284586c33b4a4d478a}{dct_uv_h}[l], udct\_h[0]);
00272                 
00273                 \hyperlink{_quantisation_8cpp_ad8c9813079b1dac9e7c7ab3d40a9a212}{iquant2x2dc_c}(udct\_h, Qp\_uv);
00274                 \hyperlink{_d_c_t_transform_8cpp_ada208d2366935100bdc2375bec45cc8f}{idct2x2dc_c}(udct\_h);
00275                 
00276                 \textcolor{keywordflow}{for}(i = 0 ; i < 4 ; i ++)
00277                 \{
00278                         \hyperlink{_quantisation_8cpp_a5985492c5cf012e5d7051f11fa86821c}{iquant4x4_c}(udct[i], Qp\_uv);
00279                         x = i>>1, y = i&1;
00280                         udct[i][0][0] = udct\_h[x][y];
00281                         x <<= 2; y <<= 2;
00282                         \hyperlink{_d_c_t_transform_8cpp_a923ec91bf45c73e8baaf4e1bbad9a289}{idct4x4_c}(udct[i]);
00283                         \textcolor{keywordflow}{for} (j = 0; j < 4; ++j)
00284                                 \textcolor{keywordflow}{for} (k = 0; k < 4; ++k)
00285                                 \{
00286                                         \hyperlink{_types_8h_a43d43196463bde49cb067f5c20ab8481}{int32} v = pred.\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[l][x|j][y|k] + (\hyperlink{_types_8h_a43d43196463bde49cb067f5c20ab8481}{int32})u
      dct[i][j][k];
00287                                         dt->\hyperlink{structmacroblockdata_a07e17343606921d436bfddef89d0d93f}{uv}[l][x|j][y|k] = \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(v);
00288                                 \}
00289                 \}
00290         \}
00291 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=174pt]{_i_macroblock_codec_8cpp_a0d5a08323fa05b03ffbebb448898663e_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_i_macroblock_codec_8cpp_a0d5a08323fa05b03ffbebb448898663e_icgraph}
\end{center}
\end{figure}


\hypertarget{_i_macroblock_codec_8cpp_a3bb69edd67d7438ffa2148822898e335}{
\index{IMacroblockCodec.cpp@{IMacroblockCodec.cpp}!macroblockIntraDecode\_\-y@{macroblockIntraDecode\_\-y}}
\index{macroblockIntraDecode\_\-y@{macroblockIntraDecode\_\-y}!IMacroblockCodec.cpp@{IMacroblockCodec.cpp}}
\subsubsection[{macroblockIntraDecode\_\-y}]{\setlength{\rightskip}{0pt plus 5cm}void macroblockIntraDecode\_\-y ({\bf pmacroblockdata} {\em dt}, \/  int {\em Qp}, \/  {\bf predictInfo} $\ast$ {\em pinfo}, \/  {\bf pmacroblockInfo} {\em mlist})}}
\label{_i_macroblock_codec_8cpp_a3bb69edd67d7438ffa2148822898e335}




\begin{footnotesize}\begin{alltt}
00024 \{
00025         \hyperlink{_types_8h_a259fa4834387bd68627ddf37bb3ebdb9}{int16} dct[16][4][4];
00026         \hyperlink{_types_8h_a259fa4834387bd68627ddf37bb3ebdb9}{int16} dct\_h[4][4];
00027 
00028         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; ++i)
00029                 \hyperlink{_scanner_8h_a368d4bb8bcbc27ebecc3939c468dbcff}{unscan_zig_4x4}(mlist->\hyperlink{structmacroblock_info_ae8398ee14b29db905e426da03b462417}{dct_y_z}[i], dct[i][0]);
00030         \textcolor{keywordflow}{if} (mlist->\hyperlink{structmacroblock_info_a6bb816cb458ac9c8f908c3f0464cd8ee}{mode_I}==\hyperlink{_consts4_standard_8h_abed82baf7f470b522273a3e37c24c600a5fc00bf550c7dd0aa35fe3c7fe664ff6}{I_16x16})
00031         \{
00032                 \hyperlink{_scanner_8h_a368d4bb8bcbc27ebecc3939c468dbcff}{unscan_zig_4x4}(mlist->\hyperlink{structmacroblock_info_a60437cc69d5df6184a6b768ff667a70f}{dct_y_h}, dct\_h[0]);
00033                 \hyperlink{_quantisation_8cpp_a480f9f1c650257964853863d5683ed34}{iquant4x4dc_c}(dct\_h, Qp);
00034                 \hyperlink{_d_c_t_transform_8cpp_ac50d1e85c45ad67944176f8ce8219dba}{idct4x4dc_c}(dct\_h);
00035         \}
00036         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; ++i)
00037         \{
00038                 \hyperlink{_quantisation_8cpp_a5985492c5cf012e5d7051f11fa86821c}{iquant4x4_c}(dct[i], Qp);
00039                 \textcolor{keywordflow}{if} (mlist->\hyperlink{structmacroblock_info_a6bb816cb458ac9c8f908c3f0464cd8ee}{mode_I}==\hyperlink{_consts4_standard_8h_abed82baf7f470b522273a3e37c24c600a5fc00bf550c7dd0aa35fe3c7fe664ff6}{I_16x16})
00040                         dct[i][0][0] = dct\_h[0][i];
00041         \}
00042         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; ++i)
00043         \{
00044                 \hyperlink{_d_c_t_transform_8cpp_a923ec91bf45c73e8baaf4e1bbad9a289}{idct4x4_c}(dct[i]);
00045         \}
00046 
00047         \hyperlink{structmacroblockdata}{macroblockdata} pred;
00048         memset(&pred, 0, \textcolor{keyword}{sizeof}(pred));
00049         \hyperlink{_types_8h_a363e4d606232036a6b89060813c45489}{uint8_t} top[24], left[16], topleft;
00050         \textcolor{keywordflow}{if} (mlist->\hyperlink{structmacroblock_info_a6bb816cb458ac9c8f908c3f0464cd8ee}{mode_I} == \hyperlink{_consts4_standard_8h_abed82baf7f470b522273a3e37c24c600a5fc00bf550c7dd0aa35fe3c7fe664ff6}{I_16x16})
00051         \{
00052                 \hyperlink{_i_predict_8cpp_a90c2994887c21abf5825c0262aa283c5}{do_16x16_luma_prediction}(pinfo, pred.\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}, mlist->\hyperlink{structmacroblock_info_a56fac1ac121007a216cd538adc034a16}{mode_i16x16});
00053                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; ++i)
00054                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 16; ++j)
00055                         \{
00056                                 \textcolor{keywordtype}{int} v = (pred.\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i][j] + dct[i/4*4+j/4][i%4][j%4])
      ;
00057                                 dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i][j] = \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(v);
00058                         \}
00059         \}
00060         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mlist->\hyperlink{structmacroblock_info_a0f244dcaf8b80e1f8adc3973e34e0a25}{transform8x8})\textcolor{comment}{//mlist->mode\_I == I\_8x8) // )//}
00061         \{
00062                 \textcolor{keyword}{const} \hyperlink{_types_8h_ac7cdb549645a4e51f5efa2fca122cc60}{UChar} \hyperlink{_p_b_macroblock_codec_8cpp_a1826216a962c3c8d20e6a32f7423ee05}{g_aucFrameScan64}[64] =
00063                 \{
00064                         0,  1,  8, 16,  9,  2,  3, 10,
00065                         17, 24, 32, 25, 18, 11,  4,  5,
00066                         12, 19, 26, 33, 40, 48, 41, 34,
00067                         27, 20, 13,  6,  7, 14, 21, 28,
00068                         35, 42, 49, 56, 57, 50, 43, 36,
00069                         29, 22, 15, 23, 30, 37, 44, 51,
00070                         58, 59, 52, 45, 38, 31, 39, 46,
00071                         53, 60, 61, 54, 47, 55, 62, 63
00072                 \};
00073                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 4; ++i)
00074                 \{
00075                         \hyperlink{_types_8h_a259fa4834387bd68627ddf37bb3ebdb9}{int16} *tmp = dct[i*4][0];
00076                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 4; ++j)
00077                         \{
00078                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 16; ++k)
00079                                         tmp[g\_aucFrameScan64[k*4+j]] = mlist->
      \hyperlink{structmacroblock_info_ae8398ee14b29db905e426da03b462417}{dct_y_z}[\hyperlink{_i_macroblock_codec_8cpp_ae22bb3624a8e7a421b4e8008720d67a5}{LUMA_INDEX}[i*4+j]][k];
00080                         \}
00081                         \hyperlink{_quantisation_8cpp_a6096528e049a8f3c2a463926db773e42}{iquant8x8_c}(dct[i*4][0], Qp);
00082                         \hyperlink{_d_c_t_transform_8cpp_aab666ffcda45ced06a5b5853c52c94bf}{idct8x8}(dct[i*4][0]);
00083                 \}
00084                 \hyperlink{_types_8h_a259fa4834387bd68627ddf37bb3ebdb9}{int16} *dct8 = dct[0][0];
00085 
00086                 memcpy(top, pinfo->\hyperlink{structpredict_info_ab44f7aab3b6e76f7be44d5420f5f4407}{top}, 24);
00087                 memcpy(left, pinfo->\hyperlink{structpredict_info_aaec86d32b8769dabe17f60051a792e19}{left}, 8);
00088                 topleft = pinfo->\hyperlink{structpredict_info_a2f363beeef9ca2f90a0db2259fc88f7b}{topleft};
00089                 \textcolor{keywordflow}{if} (mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[0]==2)
00090                 \{
00091                         \textcolor{keywordflow}{if} (!pinfo->\hyperlink{structpredict_info_a63e51107c5058064b6e8bc3fd6a08b46}{hasTop} && !pinfo->\hyperlink{structpredict_info_abe5b70fdeb86bc2d99d9c3e65250fa8e}{hasLeft})
00092                                 mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[0] = 23;
00093                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!pinfo->\hyperlink{structpredict_info_abe5b70fdeb86bc2d99d9c3e65250fa8e}{hasLeft})
00094                                 mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[0] = 21;
00095                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!pinfo->\hyperlink{structpredict_info_a63e51107c5058064b6e8bc3fd6a08b46}{hasTop})
00096                                 mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[0] = 22;
00097                 \}
00098                 \hyperlink{_i_predict_8h_a8fffa1f1faa3bee7fe022a135a996676}{out_8x8_luma_prediction} pred8;
00099                 \hyperlink{_i_predict_8cpp_a9076d5f73e7c0a6665e6e69eeaae6b10}{do_8x8_luma_prediction}(top, left, topleft, pred8, mlist->
      \hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[0]);
00100                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00101                 \{
00102                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00103                         \{
00104                                 \textcolor{keywordtype}{int} v = (pred8[i][j] + dct8[i*8+j]);
00105                                 dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i][j] = \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(v);
00106                         \}
00107                 \}
00108 
00109                 dct8 += 64;
00110                 memcpy(top, pinfo->\hyperlink{structpredict_info_ab44f7aab3b6e76f7be44d5420f5f4407}{top}+8, 16);
00111                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00112                         top[i+16] = top[15];
00113                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00114                         left[i] = dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i][7];
00115                 if (pinfo->\hyperlink{structpredict_info_a63e51107c5058064b6e8bc3fd6a08b46}{hasTop})
00116                         topleft = pinfo->\hyperlink{structpredict_info_ab44f7aab3b6e76f7be44d5420f5f4407}{top}[7];
00117                 \textcolor{keywordflow}{else}
00118                         topleft = left[0];
00119                 \textcolor{keywordflow}{if} (mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[2]==2)
00120                 \{
00121                         \textcolor{keywordflow}{if} (!pinfo->\hyperlink{structpredict_info_a63e51107c5058064b6e8bc3fd6a08b46}{hasTop})
00122                                 mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[2] = 22;
00123                 \}
00124                 \hyperlink{_i_predict_8cpp_a9076d5f73e7c0a6665e6e69eeaae6b10}{do_8x8_luma_prediction}(top, left, topleft, pred8, mlist->
      \hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[2]);
00125                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00126                 \{
00127                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00128                         \{
00129                                 \textcolor{keywordtype}{int} v = (pred8[i][j] + dct8[i*8+j]);
00130                                 dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i][j+8] = \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(v);
00131                         \}
00132                 \}
00133 
00134                 dct8 += 64;
00135                 memcpy(top, dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[7], 16);
00136                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00137                         top[i+16] = top[15];
00138                 memcpy(left, pinfo->\hyperlink{structpredict_info_aaec86d32b8769dabe17f60051a792e19}{left}+8, 8);
00139                 \textcolor{keywordflow}{if} (!pinfo->\hyperlink{structpredict_info_abe5b70fdeb86bc2d99d9c3e65250fa8e}{hasLeft})
00140                         topleft = top[0];
00141                 \textcolor{keywordflow}{else}
00142                         topleft = pinfo->\hyperlink{structpredict_info_aaec86d32b8769dabe17f60051a792e19}{left}[7];
00143                 \textcolor{keywordflow}{if} (mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[8]==2)
00144                 \{
00145                         \textcolor{keywordflow}{if} (!pinfo->\hyperlink{structpredict_info_abe5b70fdeb86bc2d99d9c3e65250fa8e}{hasLeft})
00146                                 mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[8] = 21;
00147                 \}
00148                 \hyperlink{_i_predict_8cpp_a9076d5f73e7c0a6665e6e69eeaae6b10}{do_8x8_luma_prediction}(top, left, topleft, pred8, mlist->
      \hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[8]);
00149                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00150                 \{
00151                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00152                         \{
00153                                 \textcolor{keywordtype}{int} v = (pred8[i][j] + dct8[i*8+j]);
00154                                 dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i+8][j] = \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(v);
00155                         \}
00156                 \}
00157 
00158                 dct8 += 64;
00159                 memcpy(top, dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[7]+8, 8);
00160                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 16; ++i)
00161                         top[i+8] = top[7];
00162                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00163                         left[i] = dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i+8][7];
00164                 topleft = dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[7][7];
00165                 \hyperlink{_i_predict_8cpp_a9076d5f73e7c0a6665e6e69eeaae6b10}{do_8x8_luma_prediction}(top, left, topleft, pred8, mlist->
      \hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[10]);
00166                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 8; ++i)
00167                 \{
00168                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00169                         \{
00170                                 \textcolor{keywordtype}{int} v = (pred8[i][j] + dct8[i*8+j]);
00171                                 dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[i+8][j+8] = \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(v);
00172                         \}
00173                 \}
00174 
00175         \}
00176         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (mlist->\hyperlink{structmacroblock_info_a6bb816cb458ac9c8f908c3f0464cd8ee}{mode_I} == \hyperlink{_consts4_standard_8h_abed82baf7f470b522273a3e37c24c600af6e415e1d5e44181c2ba7131f203b694}{I_4x4})
00177         \{
00178                 \hyperlink{_i_predict_8h_ad13e421d5c8f05855f5e73faad950492}{out_4x4_luma_prediction} pred4;
00179                 \hyperlink{_i_predict_8h_ac6170ef868fb47b246dc17d9767c6b7e}{info_4x4_luma_prediction} ind;
00180                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} idx = 0; idx < 16; ++idx)
00181                 \{
00182                         \textcolor{keywordtype}{int} x = (idx >> 2) * 4, y = (idx & 3) * 4;
00183                         \textcolor{keywordflow}{if} (x==0)
00184                         \{
00185                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 8; ++j)
00186                                         ind[j] = pinfo->\hyperlink{structpredict_info_ab44f7aab3b6e76f7be44d5420f5f4407}{top}[j+y];
00187                                 if ((x&4)&&(y&4) || (x && y==12))
00188                                 \{
00189                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 4; j < 8; ++j)
00190                                                 ind[j] = ind[3];
00191                                 \}
00192                         \}
00193                         \textcolor{keywordflow}{else}
00194                         \{
00195                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 4; ++j)
00196                                         ind[j] = dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[x-1][y+j];
00197                                 if ((y < 12) && ((y!=4) || (x==8))) \textcolor{comment}{// Why}
00198                                 \{
00199                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 4; j < 8; ++j)
00200                                                 ind[j] = dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[x-1][y+j];
00201                                 \}
00202                                 \textcolor{keywordflow}{else}
00203                                 \{
00204                                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 4; j < 8; ++j)
00205                                                 ind[j] = ind[3];
00206                                 \}
00207                         \}
00208                         \textcolor{keywordflow}{if} (y==0)
00209                         \{
00210                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 4; ++j)
00211                                         ind[8+j] = pinfo->\hyperlink{structpredict_info_aaec86d32b8769dabe17f60051a792e19}{left}[x + j];
00212                         \}
00213                         \textcolor{keywordflow}{else}
00214                         \{
00215                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 4; ++j)
00216                                         ind[8+j] = dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[x+j][y-1];
00217                         \}
00218                         \textcolor{keywordflow}{if} (x==0 && y==0)
00219                         \{
00220                                 ind[12] = pinfo->\hyperlink{structpredict_info_a2f363beeef9ca2f90a0db2259fc88f7b}{topleft};
00221                         \}
00222                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (x==0)
00223                         \{
00224                                 ind[12] = pinfo->\hyperlink{structpredict_info_ab44f7aab3b6e76f7be44d5420f5f4407}{top}[y-1];
00225                         \}
00226                         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (y==0)
00227                         \{
00228                                 ind[12] = pinfo->\hyperlink{structpredict_info_aaec86d32b8769dabe17f60051a792e19}{left}[x - 1];
00229                         \}
00230                         \textcolor{keywordflow}{else}
00231                                 ind[12] = dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[x-1][y-1];
00232                         \textcolor{keywordtype}{bool} hasTop = x || (pinfo->\hyperlink{structpredict_info_a63e51107c5058064b6e8bc3fd6a08b46}{hasTop}),
00233                                 hasLeft = y || (pinfo->\hyperlink{structpredict_info_abe5b70fdeb86bc2d99d9c3e65250fa8e}{hasLeft});
00234                         \textcolor{keywordtype}{int} mode = mlist->\hyperlink{structmacroblock_info_a088e83914a079456b10a7f6db04dfc46}{mode_i4x4}[idx];
00235                         \textcolor{keywordflow}{if} (mode == 2)
00236                         \{
00237                                 \textcolor{keywordflow}{if} (!hasTop && !hasLeft)
00238                                         mode = 23;
00239                                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!hasTop)
00240                                         mode = 22;
00241                                 \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (!hasLeft)
00242                                         mode = 21;
00243                         \}
00244                         \hyperlink{_i_predict_8cpp_acc4ad7a1035118020f7e66044e323e45}{do_4x4_luma_prediction}(ind, pred4, mode);
00245                         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} xx = 0; xx < 4; ++xx)
00246                                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} yy = 0; yy < 4; ++yy)
00247                                 \{
00248                                         \textcolor{keywordtype}{int} v = (pred4[xx][yy] + dct[idx][xx][yy]
      );
00249                                         dt->\hyperlink{structmacroblockdata_ac3e45382bf0c21b9714fe7d8e9e1a12d}{y}[x+xx][y+yy] = \hyperlink{_macros_8h_adf6642a5f8ea4af79e646df542b2ee06}{CLIP1}(v);
00250                                 \}
00251                 \}
00252         \}
00253 
00254 \}
\end{alltt}\end{footnotesize}




Here is the call graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=171pt]{_i_macroblock_codec_8cpp_a3bb69edd67d7438ffa2148822898e335_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=420pt]{_i_macroblock_codec_8cpp_a3bb69edd67d7438ffa2148822898e335_icgraph}
\end{center}
\end{figure}




\subsection{Variable Documentation}
\hypertarget{_i_macroblock_codec_8cpp_ae22bb3624a8e7a421b4e8008720d67a5}{
\index{IMacroblockCodec.cpp@{IMacroblockCodec.cpp}!LUMA\_\-INDEX@{LUMA\_\-INDEX}}
\index{LUMA\_\-INDEX@{LUMA\_\-INDEX}!IMacroblockCodec.cpp@{IMacroblockCodec.cpp}}
\subsubsection[{LUMA\_\-INDEX}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf LUMA\_\-INDEX}\mbox{[}16\mbox{]} = \{0, 1, 4, 5, 2, 3, 6, 7, 8, 9, 12, 13, 10, 11, 14, 15\}}}
\label{_i_macroblock_codec_8cpp_ae22bb3624a8e7a421b4e8008720d67a5}
\hypertarget{_i_macroblock_codec_8cpp_a12d5120842ae04b4f2743ad6b5fc6f74}{
\index{IMacroblockCodec.cpp@{IMacroblockCodec.cpp}!LUMA\_\-INDEX\_\-INV@{LUMA\_\-INDEX\_\-INV}}
\index{LUMA\_\-INDEX\_\-INV@{LUMA\_\-INDEX\_\-INV}!IMacroblockCodec.cpp@{IMacroblockCodec.cpp}}
\subsubsection[{LUMA\_\-INDEX\_\-INV}]{\setlength{\rightskip}{0pt plus 5cm}const int {\bf LUMA\_\-INDEX\_\-INV}\mbox{[}16\mbox{]} = \{0, 1, 4, 5, 2, 3, 6, 7, 8, 9, 12, 13, 10, 11, 14, 15\}}}
\label{_i_macroblock_codec_8cpp_a12d5120842ae04b4f2743ad6b5fc6f74}
