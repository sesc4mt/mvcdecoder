\hypertarget{_arch_windows_8h_source}{
\section{MVCCommonLib/Arch/Windows/ArchWindows.h}
}


\begin{footnotesize}\begin{alltt}
00001 \textcolor{comment}{/************************************************************************}
00002 \textcolor{comment}{ *}
00003 \textcolor{comment}{ * MVC Codec}
00004 \textcolor{comment}{ * }
00005 \textcolor{comment}{ * History}
00006 \textcolor{comment}{ * 2008-12-15           Weidong Hu              Tsinghua University             A
      dd GetAndWait and PutAndWait}
00007 \textcolor{comment}{ * 2008-12-13           Weidong Hu              Tsinghua University             A
      dd Locker}
00008 \textcolor{comment}{ * 2008-11-29           Weidong Hu              Tsinghua University             R
      eorganize}
00009 \textcolor{comment}{ * 2006-2008            Weidong Hu              Tsinghua University             C
      reate}
00010 \textcolor{comment}{ * }
00011 \textcolor{comment}{ ************************************************************************/}
00012 
00013 \textcolor{preprocessor}{#ifdef WIN32}
00014 \textcolor{preprocessor}{}\textcolor{preprocessor}{#ifndef \_ARCH\_WINDOWS\_H\_WEIDONG\_MVC\_}
00015 \textcolor{preprocessor}{}\textcolor{preprocessor}{#define \_ARCH\_WINDOWS\_H\_WEIDONG\_MVC\_}
00016 \textcolor{preprocessor}{}
00017 \textcolor{preprocessor}{#ifdef MINGW}
00018 \textcolor{preprocessor}{}\textcolor{preprocessor}{#define \_WIN32\_WINNT 0x0500}
00019 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif //MINGW}
00020 \textcolor{preprocessor}{}
00021 \textcolor{preprocessor}{#include <Windows.h>}
00022 \textcolor{preprocessor}{#include "\hyperlink{_types_8h}{Types.h}"}
00023 
00024 \textcolor{keyword}{typedef} DWORD MVCThreadHandle;
00025 \textcolor{keyword}{typedef} int (MVCThreadEntry)(\textcolor{keywordtype}{void} *param);
00026 \textcolor{keyword}{typedef} MVCThreadEntry MVCMasterThreadEntry;
00027 \textcolor{keyword}{typedef} MVCThreadHandle MVCMasterThreadHandle;
00028 
00029 \textcolor{keyword}{class }Locker
00030 \{
00031 \textcolor{keyword}{private}:
00032         CRITICAL\_SECTION critical;
00033 \textcolor{keyword}{public}:
00034         Locker();
00035         \textcolor{keyword}{virtual} ~Locker();
00036         \textcolor{keywordtype}{void} Lock();
00037         \textcolor{keywordtype}{void} Unlock();
00038 \};
00039 
00040 \textcolor{preprocessor}{#define \_\_attribute\_\_(x)  }
00041 \textcolor{preprocessor}{}
00042 \textcolor{preprocessor}{#define GetAndWait\_(dest, src, size) memcpy(dest, (void*)(src), size)}
00043 \textcolor{preprocessor}{}\textcolor{preprocessor}{#define PutAndWait\_(src, dest, size) memcpy((void*)(dest), src, size)}
00044 \textcolor{preprocessor}{}
00045 \textcolor{preprocessor}{#define GetAndWait(dest, src, size) GetAndWait\_((char *)(dest), (unsigned int)(sr
      c), size);}
00046 \textcolor{preprocessor}{}\textcolor{preprocessor}{#define PutAndWait(src, dest, size) PutAndWait\_((char *)(src), (unsigned int)(des
      t), size);}
00047 \textcolor{preprocessor}{}
00048 MVCMasterThreadHandle MVCCreateMasterThread(MVCMasterThreadEntry entry, \textcolor{keywordtype}{void} *par
      am = 0);
00049 \textcolor{keywordtype}{void} MVCWaitMasterThread(MVCMasterThreadHandle thread);
00050 
00051 \textcolor{comment}{// Called by main thread}
00052 MVCThreadHandle MVCCreateThread(MVCThreadEntry entry);
00053 \textcolor{keywordtype}{void} MVCDestroyThread(MVCThreadHandle thread);
00054 \textcolor{keywordtype}{void} MVCWaitThread(MVCThreadHandle thread);
00055 \textcolor{keywordtype}{void} MVCWriteSignal(MVCThreadHandle thread, \hyperlink{_types_8h_a1134b580f8da4de94ca6b1de4d37975e}{uint32} signal);
00056 \hyperlink{_types_8h_a1134b580f8da4de94ca6b1de4d37975e}{uint32} MVCReadSignal(MVCThreadHandle thread);
00057 \textcolor{keywordtype}{bool} MVCIsSignaled(MVCThreadHandle thread);
00058 \textcolor{keywordtype}{void} WaitSignals(MVCThreadHandle *threads, \hyperlink{_types_8h_a1134b580f8da4de94ca6b1de4d37975e}{uint32} count);
00059 
00060 \textcolor{comment}{// Called by sub-threads}
00061 \hyperlink{_types_8h_a1134b580f8da4de94ca6b1de4d37975e}{uint32} MVCReadSignal();
00062 \textcolor{keywordtype}{void} MVCWriteSignal(\hyperlink{_types_8h_a1134b580f8da4de94ca6b1de4d37975e}{uint32} signal);
00063 \textcolor{keywordtype}{bool} MVCIsSignaled();
00064 
00065 \textcolor{preprocessor}{#endif //\_ARCH\_WINDOWS\_H\_WEIDONG\_MVC\_}
00066 \textcolor{preprocessor}{}\textcolor{preprocessor}{#endif // WIN32}
\end{alltt}\end{footnotesize}
